<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="寂静的声音">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="寂静的声音">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="寂静的声音">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>寂静的声音</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">寂静的声音</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （五）Controller层实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （五）Controller层实现/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （五）Controller层实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:29:02+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-在com-hq-demo下新建一个package-为web，并在web下新建一个AreaController类"><a href="#1-在com-hq-demo下新建一个package-为web，并在web下新建一个AreaController类" class="headerlink" title="1. 在com.hq.demo下新建一个package 为web，并在web下新建一个AreaController类"></a>1. 在com.hq.demo下新建一个package 为web，并在web下新建一个AreaController类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> com.hq.demo.service.AreaService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/superadmin"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AreaService areaService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area"</span>,method = RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">queryArea</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        List&lt;Area&gt; list = areaService.queryArea();</span><br><span class="line">        modelMap.put(<span class="string">"areaList"</span>,list); <span class="comment">//前台将会从areaList获取list</span></span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;<span class="comment">//浏览器中输入http://localhost:9090/SpringBootDemo/superadmin/area可查看到信息</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area/&#123;id&#125;"</span>,method = RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">queryAreaById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer areaId)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Area area = areaService.queryAreaById(areaId);</span><br><span class="line">        modelMap.put(<span class="string">"area"</span>,area);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area"</span>,method = RequestMethod.PUT)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">insertArea</span><span class="params">(@RequestBody Area area)</span></span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> result = areaService.insertArea(area);</span><br><span class="line">        modelMap.put(<span class="string">"success"</span>,result);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area"</span>,method = RequestMethod.PATCH)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">updataArea</span><span class="params">(@RequestBody Area area)</span></span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> result = areaService.updateArea(area);</span><br><span class="line">        modelMap.put(<span class="string">"success"</span>,result);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area/&#123;id&#125;"</span>,method = RequestMethod.DELETE)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">deleteArea</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer areaId)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> result = areaService.deleteArea(areaId);</span><br><span class="line">        modelMap.put(<span class="string">"success"</span>,result);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-编写controller层的测试类"><a href="#2-编写controller层的测试类" class="headerlink" title="2. 编写controller层的测试类"></a>2. 编写controller层的测试类</h4><pre><code class="java"><span class="keyword">package</span> com.hq.demo.web;

<span class="keyword">import</span> org.junit.Before;
<span class="keyword">import</span> org.junit.Ignore;
<span class="keyword">import</span> org.junit.Test;
<span class="keyword">import</span> org.junit.runner.RunWith;
<span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;
<span class="keyword">import</span> org.springframework.http.MediaType;
<span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;
<span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;
<span class="keyword">import</span> org.springframework.test.web.servlet.setup.MockMvcBuilders;
<span class="keyword">import</span> org.springframework.web.context.WebApplicationContext;

<span class="keyword">import</span> java.time.LocalDateTime;
<span class="keyword">import</span> java.time.ZoneId;
<span class="keyword">import</span> java.util.Date;

<span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;

<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.patch;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;


<span class="comment">/**</span>
<span class="comment"> * Created by 01106066 on 2018/2/12.</span>
<span class="comment"> */</span>
<span class="meta">@RunWith</span>(SpringRunner.class)
<span class="meta">@SpringBootTest</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaControllerTest</span> </span>{

    <span class="meta">@Autowired</span>
    <span class="keyword">private</span> WebApplicationContext wac;
    <span class="keyword">private</span> MockMvc mockMvc;


    <span class="meta">@Before</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>{
        mockMvc = MockMvcBuilders.webAppContextSetup(wac).build();
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        String result = mockMvc.perform(
                get(<span class="string">"/superadmin/area"</span>)
<span class="comment">//                        .param("username", "jojo")</span>
<span class="comment">//                        .param("age", "18").param("ageTo", "60").param("xxx", "yyy")</span>
                        <span class="comment">// .param("size", "15")</span>
                        <span class="comment">// .param("page", "3")</span>
                        <span class="comment">// .param("sort", "age,desc")</span>
                        .contentType(MediaType.APPLICATION_JSON_UTF8))
                .andExpect(status().isOk()).andExpect(jsonPath(<span class="string">"$.area.length()"</span>).value(<span class="number">2</span>))
                .andReturn().getResponse().getContentAsString();

        System.out.println(result);
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAreaById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        String result = mockMvc.perform(get(<span class="string">"/superadmin/area/2"</span>)
                .contentType(MediaType.APPLICATION_JSON_UTF8))
                .andExpect(status().isOk())
                .andExpect(jsonPath(<span class="string">"$.area.areaName"</span>).value(<span class="string">"华北"</span>))
                .andReturn().getResponse().getContentAsString();

        System.out.println(result);
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        Date date = <span class="keyword">new</span> Date();
        System.out.println(date.getTime());
        String content = <span class="string">"{\"areaName\":\"华中\",\"priority\":0}"</span>;
        String reuslt = mockMvc.perform(put(<span class="string">"/superadmin/area"</span>).contentType(MediaType.APPLICATION_JSON_UTF8)
                .content(content))
                .andExpect(status().isOk())
<span class="comment">//                .andExpect(jsonPath("$.success").value("true")</span>
                .andReturn().getResponse().getContentAsString();

        System.out.println(reuslt);
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdataArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        Date date = <span class="keyword">new</span> Date(LocalDateTime.now().plusYears(<span class="number">1</span>).atZone(ZoneId.systemDefault()).toInstant().toEpochMilli());
        System.out.println(date.getTime());
        String content = <span class="string">"{\"areaId\":\"2\", \"areaName\":\"华中-更新\",\"priority\":1}"</span>;
        String reuslt = mockMvc.perform(patch(<span class="string">"/superadmin/area"</span>).contentType(MediaType.APPLICATION_JSON_UTF8)
                .content(content))
                .andExpect(status().isOk())
<span class="comment">//                .andExpect(jsonPath("$.id").value("6"))</span>
                .andReturn().getResponse().getContentAsString();

        System.out.println(reuslt);
    }

    <span class="meta">@Test</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        mockMvc.perform(delete(<span class="string">"/superadmin/area/6"</span>)
                .contentType(MediaType.APPLICATION_JSON_UTF8))
                .andExpect(status().isOk());
    }


}
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （四）Service层实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （四）Service层实现/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （四）Service层实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:27:03+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-配置"><a href="#1-配置" class="headerlink" title="1. 配置"></a>1. 配置</h4><p>在com.hq.demo.config新建package service，并新建一个类TransactionManagentConfiguration<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.config.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DataSourceTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.PlatformTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.TransactionManagementConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="comment">//事务管理</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransactionManagentConfiguration</span> <span class="keyword">implements</span> <span class="title">TransactionManagementConfigurer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">annotationDrivenTransactionManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="2-接口"><a href="#2-接口" class="headerlink" title="2. 接口"></a>2. 接口</h4><p>在com.hq.demo下新建service package，并新建<strong>接口</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AreaService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有区域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Area&gt; <span class="title">queryArea</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询区域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> areaId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Area <span class="title">queryAreaById</span><span class="params">(<span class="keyword">int</span> areaId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增区域信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> area</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">insertArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改区域信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> area</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">updateArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id删除区域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> areaId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">deleteArea</span><span class="params">(Integer areaId)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-实现"><a href="#3-实现" class="headerlink" title="3. 实现"></a>3. 实现</h4><p>在com.hq.demo.service下新建impl package，新建AreaServiceImpl实现类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.dao.AreaDao;</span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> com.hq.demo.service.AreaService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaServiceImpl</span> <span class="keyword">implements</span> <span class="title">AreaService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将业务逻辑尽可能放到service层</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AreaDao areaDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Area&gt; <span class="title">queryArea</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> areaDao.queryArea();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Area <span class="title">queryAreaById</span><span class="params">(<span class="keyword">int</span> areaId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> areaDao.queryAreaById(areaId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span> <span class="comment">//事务的控制</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">insertArea</span><span class="params">(Area area)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(area.getAreaName()!=<span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(area.getAreaName()))&#123;</span><br><span class="line">            Date time = <span class="keyword">new</span> Date();</span><br><span class="line">            area.setCreateTime(time);</span><br><span class="line">            area.setLastEditTime(time);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> row = areaDao.insertArea(area);</span><br><span class="line">                <span class="keyword">if</span>(row&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"插入区域信息失败！"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"插入区域信息失败："</span>+e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"区域信息不能为空！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateArea</span><span class="params">(Area area)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(area.getAreaId()!=<span class="keyword">null</span> &amp;&amp; area.getAreaId()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            area.setLastEditTime(<span class="keyword">new</span> Date());</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> row = areaDao.updateArea(area);</span><br><span class="line">                <span class="keyword">if</span>(row&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"更新区域信息失败！"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"更新区域信息失败："</span>+e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"区域id不能为空！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteArea</span><span class="params">(Integer areaId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(areaId!=<span class="keyword">null</span> &amp;&amp; areaId&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> row = areaDao.deleteArea(areaId);</span><br><span class="line">                <span class="keyword">if</span>(row&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"删除区域信息失败！"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"删除区域信息失败："</span>+e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"区域id不能为空！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="解决IDEA下No-Beans-of-“xxx”-type-found的报错"><a href="#解决IDEA下No-Beans-of-“xxx”-type-found的报错" class="headerlink" title="解决IDEA下No Beans of “xxx” type found的报错"></a>解决IDEA下No Beans of “xxx” type found的报错</h4><p>file –&gt; settings –&gt;Editor –&gt; Inspections –&gt; Spring –&gt; Spring Core –&gt; Code –&gt; Autowiring for bean class<br>将级别从Error调成warning，应用即可</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （三）DAO层实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （三）DAO层实现/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （三）DAO层实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:24:48+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-pom配置"><a href="#1-pom配置" class="headerlink" title="1. pom配置"></a>1. pom配置</h4><p>在pom中引入相关的依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--连接池 https://mvnrepository.com/artifact/c3p0/c3p0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="2-mybatis-config的配置"><a href="#2-mybatis-config的配置" class="headerlink" title="2. mybatis-config的配置"></a>2. mybatis-config的配置</h4><p>在src/main/resouce下建mybatis-config.xml，内容如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http//mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置全局属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用jdbc的getGeneratedKeys获取数据库自增主键值--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"useGeneratedKeys"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用列标签替换列别名 默认：true--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"useColumnLabel"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--开启驼峰命名转换：Table(create_time) &amp;ndash;&amp;gt; Entity&#123;createTime&#125;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-datasource和sessionfactorybean的配置"><a href="#3-datasource和sessionfactorybean的配置" class="headerlink" title="3. datasource和sessionfactorybean的配置"></a>3. datasource和sessionfactorybean的配置</h4><p><strong>datasource配置</strong><br>在com.hq.demo下新建packageconfig.dao，新建DataSourceConfiguration类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.config.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.beans.PropertyVetoException;</span><br><span class="line"><span class="keyword">import</span> java.lang.String;</span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//配置MyBatis mapper的扫描路径</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.hq.demo.dao"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.driver&#125;"</span>) <span class="comment">//自动读取application.properties文件中jdbc.driver的值</span></span><br><span class="line">    <span class="keyword">private</span> String jdbcDriver;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.url&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String jdbcUrl;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.username&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String jdbcUsername;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.password&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String jdbcPassword;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"dataSource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ComboPooledDataSource <span class="title">createDataSource</span><span class="params">()</span> <span class="keyword">throws</span> PropertyVetoException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        dataSource.setDriverClass(jdbcDriver);</span><br><span class="line">        dataSource.setJdbcUrl(jdbcUrl);</span><br><span class="line">        dataSource.setUser(jdbcUsername);</span><br><span class="line">        dataSource.setPassword(jdbcPassword);</span><br><span class="line">        <span class="comment">//  关闭连接后不自动commit</span></span><br><span class="line">        dataSource.setAutoCommitOnClose(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>application.properties文件补充：(仅做参考)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driver=com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://10.202.4.39:3307/leechdb?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false</span><br><span class="line">jdbc.username=??</span><br><span class="line">jdbc.password=??</span><br></pre></td></tr></table></figure></p>
<p><strong>sessionfactorybean的配置</strong><br>在com.hq.demo.config.dao下新建类SeesionFactoryConfiguration<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.config.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.String;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.ClassPathResource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SeesionFactoryConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;mybatis_config_file&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String mybatisConfigFilePath;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;mapper_path&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String mapperPath;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;entity_package&#125;"</span>)<span class="comment">//实体类所在的package</span></span><br><span class="line">    <span class="keyword">private</span> String entityPackage;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line"><span class="comment">//    @Qualifier("dataSource")</span></span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"sqlSessionFactory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactoryBean <span class="title">createSqlSessionFactoryBean</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sqlSessionFactoryBean.setConfigLocation(<span class="keyword">new</span> ClassPathResource(mybatisConfigFilePath));</span><br><span class="line">        PathMatchingResourcePatternResolver resolver = <span class="keyword">new</span> PathMatchingResourcePatternResolver();</span><br><span class="line">        String packageSearchPath = PathMatchingResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX+mapperPath;</span><br><span class="line">        sqlSessionFactoryBean.setMapperLocations(resolver.getResources(packageSearchPath));</span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSource);</span><br><span class="line">        sqlSessionFactoryBean.setTypeAliasesPackage(entityPackage);</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>application.properties文件补充：(仅做参考)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mybatis_config_file=mybatis-config.xml</span><br><span class="line">mapper_path=/mapper/**.xml</span><br><span class="line">entity_package=com.hq.demo.entity</span><br></pre></td></tr></table></figure></p>
<p><strong>这里不是采用的SpringBoot默认配置，而是自定义的datasource</strong>，所以看起来复杂许多，<br>如果使用默认配置，可参考：<a href="http://www.cnblogs.com/White-destiny/p/5531367.html" target="_blank" rel="noopener">http://www.cnblogs.com/White-destiny/p/5531367.html</a></p>
<h4 id="4-dao的创建"><a href="#4-dao的创建" class="headerlink" title="4. dao的创建"></a>4. dao的创建</h4><p>在com.hq.demo下新建package，dao，然后新建接口AreaDao<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AreaDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Area&gt; <span class="title">queryArea</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Area <span class="title">queryAreaById</span><span class="params">(<span class="keyword">int</span> areaId)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insertArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteArea</span><span class="params">(<span class="keyword">int</span> areaId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="5-mapper的编写"><a href="#5-mapper的编写" class="headerlink" title="5. mapper的编写"></a>5. mapper的编写</h4><p>在src/main/rsource下新建一个directory mapper，然后在mapper下新建AreaDao.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace：命名空间，用于隔离sql，还有一个很重要的作用，后面会讲 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.hq.demo.dao.AreaDao"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        动态代理的开发规范</span></span><br><span class="line"><span class="comment">            1: 映射文件的namespace必须等于接口的全路径名称</span></span><br><span class="line"><span class="comment">            2: 映射文件的sql唯一标示,必须等于接口的方法名称</span></span><br><span class="line"><span class="comment">            3: 映射文件的parameterType必须等于接口方法的参数类型</span></span><br><span class="line"><span class="comment">            4: 映射文件resultType必须等于接口方法的返回类型</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryArea"</span> <span class="attr">resultType</span>=<span class="string">"com.hq.demo.entity.Area"</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">        a.area_id,</span><br><span class="line">        a.area_name,</span><br><span class="line">        a.priority,</span><br><span class="line">        a.create_time,</span><br><span class="line">        a.last_edit_time</span><br><span class="line">        FROM</span><br><span class="line">        tb_area a</span><br><span class="line">        ORDER BY a.priority</span><br><span class="line">        DESC</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryAreaById"</span> <span class="attr">resultType</span>=<span class="string">"com.hq.demo.entity.Area"</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">        a.area_id,</span><br><span class="line">        a.area_name,</span><br><span class="line">        a.priority,</span><br><span class="line">        a.create_time,</span><br><span class="line">        a.last_edit_time</span><br><span class="line">        FROM</span><br><span class="line">        tb_area a</span><br><span class="line">        WHERE a.area_id=#&#123;areaId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertArea"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"areaId"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">keyColumn</span>=<span class="string">"area_id"</span> <span class="attr">parameterType</span>=<span class="string">"com.hq.demo.entity.Area"</span> &gt;</span></span><br><span class="line">        INSERT INTO</span><br><span class="line">        tb_area(area_name,priority,create_time,last_edit_time)</span><br><span class="line">        VALUES(#&#123;areaName&#125;,#&#123;priority&#125;,#&#123;createTime&#125;,#&#123;lastEditTime&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateArea"</span> <span class="attr">parameterType</span>=<span class="string">"com.hq.demo.entity.Area"</span> &gt;</span></span><br><span class="line">        UPDATE  tb_area</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"areaName!=null"</span>&gt;</span>area_name=#&#123;areaName&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"priority!=null"</span>&gt;</span>priority=#&#123;priority&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"lastEditTime!=null"</span>&gt;</span>last_edit_time=#&#123;lastEditTime&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        WHERE area_id=#&#123;areaId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteArea"</span>&gt;</span></span><br><span class="line">        DELETE FROM tb_area</span><br><span class="line">        WHERE area_id=#&#123;areaId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>mapper自动生成工具：mybatis-generator </p>
<h4 id="6-dao层测试"><a href="#6-dao层测试" class="headerlink" title="6. dao层测试"></a>6. dao层测试</h4><p><strong>编写单元测试</strong><br>在Windows环境下，选择AreaDao类，按Alt+Enter键，Create Test；如果是Mac环境下，则是Option+Enter键</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> org.junit.Ignore;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AreaDao areaDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        List&lt;Area&gt; areaList = areaDao.queryArea();</span><br><span class="line">        assertEquals(<span class="number">2</span>, areaList.size());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line"><span class="comment">//    @Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAreaById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Area area = areaDao.queryAreaById(<span class="number">1</span>);</span><br><span class="line">        assertEquals(<span class="string">"华南"</span>,area.getAreaName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Area area = <span class="keyword">new</span> Area();</span><br><span class="line">        area.setAreaName(<span class="string">"华东"</span>);</span><br><span class="line">        area.setPriority(<span class="number">0</span>);</span><br><span class="line">        area.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">        <span class="keyword">int</span> row = areaDao.insertArea(area);</span><br><span class="line">        assertEquals(<span class="number">1</span>,row);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Area area = <span class="keyword">new</span> Area();</span><br><span class="line">        area.setAreaId(<span class="number">3</span>);</span><br><span class="line">        area.setAreaName(<span class="string">"华东-更新"</span>);</span><br><span class="line">        area.setLastEditTime(<span class="keyword">new</span> Date());</span><br><span class="line">        <span class="keyword">int</span> row = areaDao.updateArea(area);</span><br><span class="line">        assertEquals(<span class="number">1</span>,row);<span class="comment">//影响行数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> row = <span class="keyword">this</span>.areaDao.deleteArea(<span class="number">3</span>);</span><br><span class="line">        assertEquals(<span class="number">1</span>,row);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （二）表设计与实体类创建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （二）表设计与实体类创建/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （二）表设计与实体类创建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:23:23+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-设计表"><a href="#1-设计表" class="headerlink" title="1. 设计表"></a>1. 设计表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tb_area`</span>(</span><br><span class="line"><span class="string">`area_id`</span> <span class="built_in">int</span>(<span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line"><span class="string">`area_name`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`priority`</span> <span class="built_in">INT</span>(<span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</span><br><span class="line"><span class="string">`create_time`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'创建时间'</span>,</span><br><span class="line"><span class="string">`last_edit_time`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'修改时间'</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`area_id`</span>),</span><br><span class="line"><span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`UK_AREA`</span>(<span class="string">`area_name`</span>)</span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'区域表'</span>;</span><br></pre></td></tr></table></figure>
<h4 id="2-创建实体类"><a href="#2-创建实体类" class="headerlink" title="2. 创建实体类"></a>2. 创建实体类</h4><p>DAO层设计，新建一个package，用来存放所有的实体类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Area</span> </span>&#123;</span><br><span class="line"><span class="comment">//成员变量与数据库表的字段相对应，驼峰规则</span></span><br><span class="line">    <span class="keyword">private</span> Integer areaId;</span><br><span class="line">    <span class="keyword">private</span> String areaName;</span><br><span class="line">    <span class="keyword">private</span> Integer priority;</span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line">    <span class="keyword">private</span> Date lastEditTime;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAreaId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> areaId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAreaId</span><span class="params">(Integer areaId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.areaId = areaId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAreaName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> areaName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAreaName</span><span class="params">(String areaName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.areaName = areaName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getPriority</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> priority;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPriority</span><span class="params">(Integer priority)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.priority = priority;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getCreateTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCreateTime</span><span class="params">(Date createTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.createTime = createTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getLastEditTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lastEditTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastEditTime</span><span class="params">(Date lastEditTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lastEditTime = lastEditTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/SpringBoot+MyBatis搭建微信小程序】—— （一）搭建SpringBoot+MyBatis框架 ---/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/SpringBoot+MyBatis搭建微信小程序】—— （一）搭建SpringBoot+MyBatis框架 ---/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （一）搭建SpringBoot+MyBatis框架</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:21:49+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="需要用到的工具"><a href="#需要用到的工具" class="headerlink" title="需要用到的工具"></a>需要用到的工具</h4><p>JDK<br>STS:：<a href="http://spring.io/，一个类似于eclipse的工具" target="_blank" rel="noopener">http://spring.io/，一个类似于eclipse的工具</a>,  或者IDEA:<br>MySQL：</p>
<h4 id="1-使用IDEA新建工程"><a href="#1-使用IDEA新建工程" class="headerlink" title="1. 使用IDEA新建工程"></a>1. 使用IDEA新建工程</h4><ol>
<li>New Project</li>
<li>Spring Installer –&gt; 选择JDK</li>
<li>配置工程的group等</li>
<li>选择Spring版本，配置Web，MyBatis，MySQL等</li>
<li>工程命名</li>
<li>Finish后记得配置本地的Maven（Setting–&gt; Maven）</li>
</ol>
<h4 id="2-如何启动工程"><a href="#2-如何启动工程" class="headerlink" title="2. 如何启动工程"></a>2. 如何启动工程</h4><p>在IDEA新建工程时，在src/main/java/<em>*</em>下会有一个DemoApplication类，内容如下，启动这个类即可。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果出现<strong>Cannot determine embedded database driver class for database type NONE</strong>的错误，在pom.xml中注释掉springboot mybatis 依赖就可以了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">         &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;</span><br><span class="line">         &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">         &lt;version&gt;1.3.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>IDEA可以用Ctrl+/快速注释</p>
<h4 id="3-写一个Hello的Controller"><a href="#3-写一个Hello的Controller" class="headerlink" title="3. 写一个Hello的Controller"></a>3. 写一个Hello的Controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/hello"</span>,method = RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello SpringBoot!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动工程，访问<a href="http://localhost:8080/hello即可看到结果" target="_blank" rel="noopener">http://localhost:8080/hello即可看到结果</a></p>
<p>以上，就是一个简单的Demo了，后续的步骤仅仅作为定制化的需要</p>
<h4 id="4-如何修改默认端口"><a href="#4-如何修改默认端口" class="headerlink" title="4. 如何修改默认端口"></a>4. 如何修改默认端口</h4><p>在src/main/resource目录下会有一个application.properties文件，加入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.port=9090</span><br></pre></td></tr></table></figure></p>
<p>访问<a href="http://localhost:9090/hello即可看到结果" target="_blank" rel="noopener">http://localhost:9090/hello即可看到结果</a></p>
<h4 id="5-如何访问路径修改"><a href="#5-如何访问路径修改" class="headerlink" title="5. 如何访问路径修改"></a>5. 如何访问路径修改</h4><p>如果想通过<a href="http://localhost:9090/SpringBootDemo/hello访问（即带上工程名）" target="_blank" rel="noopener">http://localhost:9090/SpringBootDemo/hello访问（即带上工程名）</a><br>在application.properties文件加入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.context-path=/SpringBootDemo</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/05/曾国藩的转变/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/05/曾国藩的转变/" itemprop="url">曾国藩的转变</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-05T00:50:12+08:00">
                2018-02-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>小时候，我们姐妹几个经常会和长辈们坐一起唠嗑，为了激励我们几个好好学习，天天向上，长辈们经常给我们讲一些小故事，其中这个曾国藩因背书慢被小偷骂的故事记忆犹新。</p>
<p>据说某天夜里，一个贼光顾了曾国藩的家里，躲在房梁上，准备趁着一家人睡着之后偷东西，当时曾国藩正在反复背诵《岳阳楼记》，“庆历四年春，滕子京谪守巴陵郡……”一遍，两遍，三遍……就是背不下来，也不肯去休息。小偷等的久了，又气又恼，终于忍不住跳出来，对着年轻的曾国藩大骂：“你这种水准，读什么书？我听你念了三遍就背出来的文章，你背了一个多时辰还背不出吗？”说完，还当着他的面，流畅地将文章背诵一遍，扬长而去。</p>
<p>当时听的我们哈哈大笑，这个故事应该是杜撰的，只是为了凸显出曾国藩的“笨”，相比左宗棠，李鸿章这类晚清重臣，曾国藩的确显得有些“笨”，尤其是早期的他，显得有些单纯，不灵巧。</p>
<p>曾国藩从小受的就是儒家教育，君君臣臣，父父子子，讲究每一个人恪守自己的本分，讲究克己复礼，追求文死谏，武死战，所以他对自己要求很严格，这无可厚非，可是现实世界是复杂的，不是每个人都会完完整整的遵循儒家的那一套，他却也用这种高要求去要求别人，这就难免让人觉得很不舒服。咸丰皇帝让他提点意见，他还真提，提了也就罢了，那意见还提的字字戳心，一把就把领导得罪了。对同僚也是如此，不符合他那一套道德标准的，直接打报告给皇帝，将对方革职查办了。对下属呢，辛辛苦苦打了胜仗，也不肯为他们谋取更多的好处，异常的严苛，最后闹的大家都不待见他。那个时候的曾国藩是真的很郁闷，从他的书信来看，多少次想要寻死的心都有。</p>
<p>1856年，轰轰烈烈的天京事变，让朝廷觉得太平天国不过是秋后的蚂蚱，蹦跶不了几天了，于是曾国藩越发不受待见，灰溜溜的回湖南老家丁忧守孝去了。</p>
<p>行至此处。一个坚持自己道德标准的人，错了吗？</p>
<p>回家之后的曾国藩，再出山，已经是脱胎换骨，变了个人。他变得<strong>不再给人难堪</strong>，面对皇帝的瞎指挥，他不再是直言拒绝，而是玩起了太极，找各种借口去回避，甚至有些借口还很荒唐。别人给他送礼，他也不会不收，也不会全收，拿一小点意思意思，也不会去参别人一本。太平天国打下来之后，湘军瓜分了天京的金银珠宝，朝廷找他要银子，他拿不出，还因此赏赐降了一等。</p>
<blockquote>
<p><strong>一个人的精神境界想要上个层次，仅仅往外求，即通过各种各样生活方式的改变来逼自己改变，不是根本性的方法。根本性的方法，是对外人变得更加通达，是内心的容量变得充分放大。</strong></p>
</blockquote>
<p>《红楼梦》中的贾雨村，不知你是否还有印象，初入官场的他难免不懂规矩，很快就被人弹劾，丢官，只能去林如海家当林黛玉的老师。后来他凭借贾家的力量东山再起，在面对之前恩人甄士隐先生的女儿的案件时，他一步步被现实吞噬，最终沦为黑暗官场的一部分。</p>
<p>表面上看起来，曾国藩似乎也是一步步的在“沦落”，那他与贾雨村之流的区别在哪里呢？那就是他仍然有自己的原则，对自己仍然有道德要求，甚至这种要求很严格，只不过，他不再用这样的要求去要求别人了。也就是那句老话了，严于律己，宽以待人。是不是你也和我一样，把一句耳详能熟的道理没当回事？</p>
<p>我今天之所以写这些，是我看到了自己身上年轻时曾国藩的影子，一样的理想主义，也用自己内心的标准去要求别人，甚至还因此跟人起冲突，也让自己遭罪。</p>
<p>可是现实世界是复杂的，每个人的经历感受都不一样，每个人面对现实世界所看到的也不一样，怎能用一套标准去要求所有人呢？水至清则无鱼，正是由于各式各样的人才组成了这个真实的活生生的世界。</p>
<p>我想起了海瑞，一辈子的清官，成为了一个符号，挂在哪里，人们敬重他，他周围的人却远离他。我看《万历十五年》时，越发觉得最后复出的他显得悲凉，他的梦想破碎了。</p>
<p>如果把现实世界当作煮沸的开水，有的人是胡萝卜，很快就炖成泥，既外化也内化，比如贾雨村。有的人是鸡蛋，很快就煮硬了，既不内化也不外化，比如海瑞。有的人是茶叶，片片叶子舒展开来，茶香四溢，外化而内不化，比如曾国藩。</p>
<p>反省自身，以此自勉。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/04/客观题与主观题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/04/客观题与主观题/" itemprop="url">客观题与主观题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-04T10:48:54+08:00">
                2018-02-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近在万维钢大的专栏中看到一篇文章，觉得很有意思。</p>
<p>对于客观题与主观题，对于经历过这么多年应试教育的我们来说那真的是一点都不陌生，当我们拿到考卷的时候，比如语文，前面的选择填空题我们会知道只有唯一正确答案，而后面的诗词鉴赏，阅读理解以及大小作文就没有唯一正确答案了，言之成理即可。</p>
<p><strong>判断客观题与主观题，主要看是否有绝对的对错，或者说是否有唯一正确答案。</strong></p>
<p>像文史哲这类学科，更多的是主观题，比如“秦王朝为何灭亡”，你说秦王暴政也好，你说它大有大的难处也好，这么大个事件，它不是单一因素所造成的，这就需要我们站在各种不同的角度去分析和理解。而数理化呢？解的都是客观题，是有唯一正确答案的，3的平方一定得是9，不可能是10，你的回答如果是10 ，那我就可以反驳你说，你的答案错了，这是有绝对的对错。</p>
<p>现在我们知道了什么是主观题，什么是客观题。</p>
<p>我们接下来看一道题：<br>关于堕胎，老张和老王有不同的观点，</p>
<blockquote>
<p>老张：堕胎是完全符合道德的事情，应该合法。<br>老王：堕胎是不道德的，应法律禁止。</p>
</blockquote>
<p>我们先抛开自己本身对堕胎这个问题的看法，来看一下这道题，<strong>你认为这道题是主观题还是客观题？</strong></p>
<p>如果你认为是客观题，那么你会觉得堕胎要么合法，要么不合法，反正就是要么老张对，要么老王对，我们姑且称这一派为客观派；如果你认为这道题是主观题，那么你会觉得到底应不应该允许堕胎这个问题无所谓对错，只有个人观点不同，这一类我们称主观派吧。</p>
<p>那么，你有没有发现，<strong>客观派的人思想相对比较封闭</strong>。我觉得粽子应该是甜的，你认为粽子应该是咸的，那咱啥也甭谈了，客观派认为这个问题有唯一的对错，就容易不愿意与观点相左的人进行沟通，甚至觉得坐在一起都难受，这样的例子我们在生活中不少见吧。<strong>这就是典型的思想影响行为。</strong></p>
<p>我们还是回到“粽子应该是甜的还是咸的”这个问题上来，现在我们吵起来了，我就觉得因该是甜的，你就觉得应该是咸的，好，打住一下。</p>
<p><strong>请问：我们现在争吵的是否是同一个问题？</strong></p>
<p>事实上，只是我喜欢甜的，你喜欢咸的，咱们只是口味不同，那这就是道主观题了。主观题就没必要形成争吵。</p>
<p><strong>如果我们认为一道题是主观题，对我们有什么好处？我们不会认死理，会愿意抱着学习的态度和对方进行沟通。</strong>比如粽子这个问题，我现在觉得不一定非得是甜的或者是咸的，但是我想听听你为什么觉得应该是咸的，看看你是否言之成理，甚至我也可以尝尝咸粽子嘛。</p>
<p>还有个问题，如果你觉得这道题就是道客观题，怎么办？<strong>假装这道题介于主观题和客观题的灰色地带</strong>，表现的不认死理，这是行为，<strong>行为是可影响认知的</strong>，我有个朋友，心情不好的时候不会表现的垂头丧气，反而是正身抬头，精神饱满，这其实就是一种行为影响认知的应用，在沟通中也可采用这一招，</p>
<p>总结一下：**</p>
<ol>
<li>判断一道题是主观题还是客观题。若是已经争吵，判断吵的是否是同一道题。</li>
<li>如果觉得是主观题，那就抱着学习的态度去沟通。</li>
<li>如果觉得是客观题，那也先假装这道题介于主观题和客观题的灰色地带，也抱着学习的态度去沟通。**</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/23/玩一把谁是大富翁/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/23/玩一把谁是大富翁/" itemprop="url">玩一把我是大老板</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-23T21:23:06+08:00">
                2018-01-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我是大老板是一种谈判性质的桌面游戏，从来没玩过这个游戏，第一次玩侥幸赢了，规则都还没怎么摸清楚的情况下，多是别人让着我，不过我觉得这个游戏挺有意思的，生活中大多数人都在为钱而奔波，而这款棋牌游戏很有钱的味道，多方玩家参与做生意，主要通过谈判与合作，生意能否谈成，利益分配是否能得到参与各方的认可等等，这些都需要在谈判桌上一一达成。我这里会介绍一下这个游戏及其玩法，然后再谈谈我在这个游戏中的心得体会。</p>
<h3 id="游戏配件"><a href="#游戏配件" class="headerlink" title="游戏配件"></a>游戏配件</h3><ul>
<li>6张代表财团的资本家卡片;（我们也叫双面角色卡，每一轮都可使用）</li>
<li>98张影响力卡（包括24张不同财团的家族卡,21张旅行卡,33张召募卡,10张大老板卡,以及10张停止卡）15张景气卡；（家族卡是单面角色卡，只能用一次；旅行卡可以让对应的单面或双面角色卡去旅行，即让其在谈判桌上出局；三张招募卡就可以抢别人的双面角色卡；老板卡就是宣布＂我是老板！＂，那么前任老板立刻被解职；一张停止卡可停止旅行卡，两张停止卡可停止老板卡，三张才能停止招募卡）</li>
<li>1个标示当下投资机会的金钱标示物;</li>
<li>1枚骰子;</li>
<li>110张现金卡；（谈判成功后要分钱的）</li>
<li>2本规则.</li>
</ul>
<h3 id="游戏简介"><a href="#游戏简介" class="headerlink" title="游戏简介"></a>游戏简介</h3><p>游戏板上有16笔利润丰厚的投资机会；即16个方格，每一格代表一个投资机会。<br>每个投资机会都标上此次交易所需要的投资人（不同资本家或其家族成员）和成交金额；比如需多少人参与，利益是当前景气卡的多少倍，对投资人的要求等等。<br>一笔交易要求的投资者越多,则成交金额越大。<br>每次投资机会所产生的利润基数由当时市场上的景气卡来决定。<br>每个投资机会的灰色区块旁边的数字表示选择该灰色区块中需要参与的财团人数。<br>若有彩色的财团资本家的名字,则是必须参与此次交易的资本家或者是家族成员。</p>
<h3 id="具体游戏规则"><a href="#具体游戏规则" class="headerlink" title="具体游戏规则"></a>具体游戏规则</h3><h4 id="游戏准备"><a href="#游戏准备" class="headerlink" title="游戏准备"></a>游戏准备</h4><ol>
<li><p>将6张代表不同财团的资本家卡片(资本家的卡片两面都有图)随机发给每位玩家，将这张卡片牌面向上放在桌上，玩家面前的资本家象征了你可以操纵该财团进行交易。</p>
</li>
<li><p>将其它的卡片洗牌均匀.每位玩家得到5张牌面向下的卡片,将它们拿在手中.剩下的卡片牌面向下放在游戏板中央.不要让其它玩家看到自己的手牌.</p>
</li>
<li><p>景气卡按照数字顺序放在游戏板中央.第1号景气卡放在最上面;15号景气卡在最下面;上面分别写有每股=2百万、3百万、4百万不等,越到游戏后期越有高额商机.</p>
</li>
</ol>
<h4 id="游戏过程"><a href="#游戏过程" class="headerlink" title="游戏过程"></a>游戏过程</h4><ol>
<li>顺时针方向，大家轮流掷骰子，轮到自己掷骰子时，自己就是这一局的初始大老板。</li>
<li>轮到自己回合的时候，玩家先掷骰子，然后根据顺时针或逆时针方向走对应骰子点数的格子数，如果遇到已经谈成了的生意（上面会有景气卡）就直接跳过该格（已经用过的投资机会不能再用），此时玩家可以</li>
</ol>
<ul>
<li>就新的投资机会展开集资</li>
<li>或是从牌堆抽取三张影响力卡片,接着轮到你左边的玩家.</li>
</ul>
<ol>
<li>如果选择交易投资</li>
</ol>
<ul>
<li>玩家发起一场当前投资机会的合作谈判，并在这一轮的谈判中担任大老板</li>
<li>投资机会中标明了需要哪些资本家参与，其他玩家可以根据自己手里的资本家卡片，选择是否参与本轮投资，并开价</li>
<li>一个玩家可以控制多位资本家,那么这些卡片全部进场；由大老板选择想要合作的玩家</li>
<li>其他玩家可以在谈判过程中打出影响卡影响谈判</li>
<li>激烈的讨价还价</li>
<li>有可能交易成功，也有可能交易失败</li>
<li>若交易成功可获得现金卡，即获得了多少钱。</li>
</ul>
<ol>
<li>如果选择抽取卡片</li>
</ol>
<ul>
<li>如果手里有资本家，抽取三张影响卡；如果没有，可抽取四张</li>
<li>手里的卡片不得超过十二张，超过十二张就必须谈判做生意。</li>
</ul>
<h4 id="游戏结束"><a href="#游戏结束" class="headerlink" title="游戏结束"></a>游戏结束</h4><p>当第十次投资开始时，将以掷骰决定游戏是否结束，在每一次交易成功之后，大老板将景气板放在交易空格上，接着掷骰，如果景气板背面的数字之一被掷出，那么市场投资的机会伴随着游戏同时结束。</p>
<p>最后就是统计一下谁赚的钱最多了，赚得多的就是赢家了。</p>
<h3 id="我的想法"><a href="#我的想法" class="headerlink" title="我的想法"></a>我的想法</h3><p>尽量让自己手里筹码更多<br>游戏开始阶段，最初的几次交易交易金额较少，可选择策略性的累积重要手牌例如：老板卡、停止卡、任意旅行卡，在必要的时候可在交易阶段无意义的打出手牌，以合理控制手牌数量。我们在玩的过程中有一名玩家，姑且叫他A君吧，A君在前期基本没怎么赚钱，但他做了一件事，抢别的玩家的资本家卡，导致游戏后期大家不得不跟他做生意，后面几把就把前面的全补回来了。其实就是在游戏中尽量让自己的筹码更多，越强大的一方在谈判桌上越有优势。这让我想起了一个忧伤的故事。第一次世界大战之后的巴黎和会，中国作为弱国与美国合作，想要索回德国强占的山东半岛的主权，美国一开始也是支持中国的，不过日本对山东虎视眈眈，原本以为含在嘴里的肉现在要吐出来，气的直跺脚。可是日本当时是强国，强国就有强国的玩法，即便中国代表团的致辞有理有据，振振有词，他也可以有其他的手段逼迫美国放弃中国这点蝇头小利，最终谈判决定战前德国侵占的山东胶州湾的领土，以及那里的铁路、矿产、海底电缆等，统统归日本所有，中国代表团拒绝签字，巴黎和会谈判失败，后续的五四运动大家都知道了。</p>
<p>一笔生意不要太贪，尤其是早中期<br>我们在游戏的过程中，有一笔生意是1800万的，大老板仗着自己手里的优势，给另外两位玩家只有200万，自己获得了1400万的超额利润。结果就是，后面大家能不带他玩就不带他玩。</p>
<p>我喜欢和气生财，积少成多<br>几乎每一笔生意，我多多少少都能赚上一点，可多可少，没有一笔是赚的非常显眼的，我手里尽管有不少影响卡，但在别人不攻击我的情况下，我不会去做恶，但被其他玩家攻击时，我有还手的余地，这让我在谈判桌上积累了很好的人脉，大家也都愿意找我合作，于是我就能极少成多，最后竟然不声不响的赢的最多。</p>
<p>推荐一下这个游戏，不妨一试。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/13/Fiddler自动保存/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/13/Fiddler自动保存/" itemprop="url">Fiddler自动保存</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-13T20:06:50+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近接手一个新项目的自动化测试，由于项目还处于前期不太稳定的阶段，考虑到性价比，所以先做了接口的自动化测试，但是，由于HTTP请求进行了定制的加密处理，与项目经理沟通无果，这无疑加大了我的工作量。其中很大一个工作量就是，大量的用Fiddler抓取请求和响应，再拿去解密，分析。为了偷懒，于是有了此文。</p>
<h4 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h4><p>大致的步骤如下：</p>
<ol>
<li>Fiddler菜单 –&gt; Rules –&gt; Customize Rules</li>
<li>如果提示没有下载Fiddler ScriptEditor则按提示下载后进入下一步操作</li>
<li>安装好Fiddler ScriptEditor后，就能打开Customize Rules.js文件</li>
<li>编辑Customize Rules.js文件，并保存</li>
<li>重启fiddler<br>那么，重点就是如何修改这个js文件了。</li>
</ol>
<h4 id="设置开关"><a href="#设置开关" class="headerlink" title="设置开关"></a>设置开关</h4><p>在CustomRules.js文件发现了这样一段代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">RulesOption</span><span class="params">(<span class="string">"Hide 304s"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">BindPref</span><span class="params">(<span class="string">"fiddlerscript.rules.Hide304s"</span>)</span></span></span><br><span class="line"><span class="function">var m_Hide304s: <span class="keyword">boolean</span> </span>= <span class="keyword">false</span>;</span><br></pre></td></tr></table></figure></p>
<p>其实上面这段代码提供了菜单Rules –&gt; Hide 304s的开关控制功能，我们可以依葫芦画瓢，写上这么两行。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Data Storage</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">RulesOption</span><span class="params">(<span class="string">"Data Storage"</span>)</span></span></span><br><span class="line"><span class="function">var m_DataStorage: <span class="keyword">boolean</span> </span>= <span class="keyword">false</span>;</span><br></pre></td></tr></table></figure></p>
<p>保存CustomRules.js后，马上会在Rules菜单下看到Data Storage选项，勾上后，变量m_DataStorage就设置为true，反之false。</p>
<h4 id="保存请求"><a href="#保存请求" class="headerlink" title="保存请求"></a>保存请求</h4><p>把下面代码贴在<strong>OnBeforeRequest()</strong>方法末尾<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (m_DataStorage)&#123;</span><br><span class="line">	<span class="comment">//当开关打开时才生效	</span></span><br><span class="line">	<span class="comment">//过滤无关请求，只关注特定请求</span></span><br><span class="line">	<span class="keyword">if</span> (oSession.fullUrl.Contains(<span class="string">"rf-app"</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		var fso;</span><br><span class="line">		var file;</span><br><span class="line">		fso = <span class="keyword">new</span> ActiveXObject(<span class="string">"Scripting.FileSystemObject"</span>);</span><br><span class="line">		<span class="comment">//文件保存路径，可自定义</span></span><br><span class="line">		file = fso.OpenTextFile(dataPath+<span class="string">"request.txt"</span>,<span class="number">8</span> ,<span class="keyword">true</span>, <span class="keyword">true</span>);</span><br><span class="line">		file.writeLine(<span class="string">"Request url: "</span> + oSession.url);</span><br><span class="line">		file.writeLine(<span class="string">"Request header:"</span> + <span class="string">"\n"</span> + oSession.oRequest.headers);</span><br><span class="line">		file.writeLine(<span class="string">"Request body: "</span> + oSession.GetRequestBodyAsString());</span><br><span class="line">		file.writeLine(<span class="string">"\n"</span>);</span><br><span class="line">		file.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里我需要补充一下OpenTextFile方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object.OpenTextFile(filename[, iomode[, create[, format]]])</span><br></pre></td></tr></table></figure></p>
<p>参数说明：<br>object：必选项。 object 应为 FileSystemObject 的名称。<br>filename：必选项。 指明要打开文件的字符串表达式。<br>iomode：可选项。 可以是三个常数之一： ForReading 、 ForWriting 或 ForAppending 。<br>create：可选项。 Boolean 值，指明当指定的 filename 不存在时是否创建新文件。 如果创建新文件则值为 True ，如果不创建则为 False 。 如果忽略，则不创建新文件。<br>format：可选项。 使用三态值中的一个来指明打开文件的格式。 如果忽略，那么文件将以 ASCII 格式打开。</p>
<p>其中：<br>iomode 参数可以是下列设置中的任一种：<br>ForReading 1 以只读方式打开文件。 不能写这个文件。<br>ForWriting 2 以写方式打开文件<br>ForAppending 8 打开文件并从文件末尾开始写。<br>我在此处直接写的8，意思就是在文件尾追加内容。</p>
<p>format 参数可以是下列设置中的任一种：<br>TristateTrue 以 Unicode 格式打开文件。<br>TristateFalse 以 ASCII 格式打开文件。<br>TristateUseDefault 使用系统默认值打开文件。<br><strong>编码格式需要格外注意，我在用Java代码读出这些保存下来的txt文件时，会因为编码格式而报错，如果你的请求中没有中文，保存的时候可以考虑用ASCII的格式，UTF-8兼容ASCII码</strong></p>
<h4 id="保存响应"><a href="#保存响应" class="headerlink" title="保存响应"></a>保存响应</h4><p>把下面代码贴在OnBeforeResponse()方法末尾<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (m_DataStorage)&#123;	</span><br><span class="line">	<span class="comment">//过滤无关请求，只关注特定请求</span></span><br><span class="line">	<span class="keyword">if</span> (oSession.fullUrl.Contains(<span class="string">"rf-app"</span>))</span><br><span class="line">	&#123;</span><br><span class="line">        oSession.utilDecodeResponse();<span class="comment">//消除保存的请求可能存在乱码的情况</span></span><br><span class="line">		var fso;</span><br><span class="line">		var file;</span><br><span class="line">		fso = <span class="keyword">new</span> ActiveXObject(<span class="string">"Scripting.FileSystemObject"</span>);</span><br><span class="line">		<span class="comment">//文件保存路径，可自定义</span></span><br><span class="line">		file = fso.OpenTextFile(dataPath+<span class="string">"reponse.txt"</span>,<span class="number">8</span> ,<span class="keyword">true</span>, <span class="keyword">true</span>);</span><br><span class="line">		file.writeLine(<span class="string">"Response code: "</span> + oSession.responseCode);</span><br><span class="line">        file.writeLine(<span class="string">"Response body: "</span> + oSession.GetResponseBodyAsString());</span><br><span class="line">		file.writeLine(<span class="string">"\n"</span>);</span><br><span class="line">		file.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>说明：dataPath是我定义的全局变量，注意：要自己先在D盘创建fiddler的文件夹，否则会报错<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//存储路径	</span></span><br><span class="line"><span class="keyword">static</span> var dataPath: String = <span class="string">"D://fiddler//"</span>;</span><br></pre></td></tr></table></figure></p>
<p><img src="/Users/grace/Desktop/a14b61a2-0569-49e8-8946-15129d618e27.png!large.png" alt="a14b61a2-0569-49e8-8946-15129d618e27.png!large"></p>
<h4 id="结果展示"><a href="#结果展示" class="headerlink" title="结果展示"></a>结果展示</h4><p><img src="/Users/grace/Desktop/3a4bde9c-a6cc-4d16-86df-f60cad10d8d7.png!large.png" alt="3a4bde9c-a6cc-4d16-86df-f60cad10d8d7.png!large"><br><img src="/Users/grace/Desktop/18f40cd9-4bad-44cf-83eb-c7969d51b5a3.png!large.png" alt="18f40cd9-4bad-44cf-83eb-c7969d51b5a3.png!large"></p>
<h4 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h4><p>保存下来的文件内容是加密了的，还需要我再解密输出。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadFiddlerData</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String requestFile = <span class="string">"D:\\fiddler\\data.txt"</span>;	</span><br><span class="line">		<span class="keyword">try</span> &#123;	</span><br><span class="line">			String s1 = <span class="keyword">null</span>,data = <span class="keyword">null</span>;</span><br><span class="line">			JSONObject dataobj = <span class="keyword">new</span> JSONObject();</span><br><span class="line">			BufferedReader rf = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(requestFile),<span class="string">"UTF-8"</span>));</span><br><span class="line">			<span class="keyword">while</span> ((s1 = rf.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (s1.contains(<span class="string">"="</span>))&#123;</span><br><span class="line">					data = ((s1.split(<span class="string">"="</span>))[<span class="number">1</span>]).replace(<span class="string">" "</span>, <span class="string">""</span>);</span><br><span class="line"><span class="comment">//					System.out.println(data);</span></span><br><span class="line">					System.out.println(MssUtil.decrypt(data));</span><br><span class="line"></span><br><span class="line">				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(s1.contains(<span class="string">"\":\""</span>))&#123;</span><br><span class="line">					dataobj = JSONObject.fromObject(s1);</span><br><span class="line">					data = dataobj.getString(<span class="string">"data"</span>).replace(<span class="string">" "</span>, <span class="string">""</span>);</span><br><span class="line"><span class="comment">//					System.out.println(data);</span></span><br><span class="line">					System.out.println(MssUtil.decrypt(data));</span><br><span class="line">				&#125;</span><br><span class="line">				Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>除了保存这些报文以外，还可以做点别的，比如看到好的图片想要自动保存等，Fiddler是一个挺强大的工具，感兴趣的可以深入研究一下。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/05/谈谈罗子君和唐晶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/05/谈谈罗子君和唐晶/" itemprop="url">谈谈《我的前半生》里的唐晶</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-05T08:26:12+08:00">
                2017-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>《我的前半生》之前很火，我却一直没看，原谅我并不是个喜欢追热剧的人。去年十一回家，晚上和叔叔聊天，他却说起了这部电视剧，不知是有意还是无意，反复的跟我说唐晶那样子的女强人，那样子的职场精英，那样子的独立个性，却没和贺涵修成正果，然后话锋一转，“女人啊，个性独立要强有什么用？”我想他大概是觉着我身上有点唐晶的影子，怕我奔着剩女而去，所以才对我说这些。这几年来我都信奉靠自己，要做独立自强的女性，执着于自己的追求，不过确实暂时还没有收获自己的爱情，但是起码到那个时候为止，我不认为这样有什么错。那时我还未看过《我的前半生》，不了解唐晶这个角色，也就没多说什么。</p>
<p>后来工作之余有时间偶然看了几集，说实话，前面几集看到罗子君，我真有点看不下去，打心里不喜欢这个角色，分分钟想弃剧，并未看到子君蜕变的那一刻就直奔大结局去了，结局的唐晶真的让人心疼。我能明显的看到前期的子君的毛病，但是，我却不知道唐晶到底错在哪里，为什么？为什么这么好的一个姑娘却最终失去了自己的爱情？我真的不懂。</p>
<p>这两日，我忽然想起电视剧中的一处情节。那日贺涵带唐晶到自己刚装修好的新房子里，他希望借此机会委婉的向唐晶求婚，希望给十年长跑画上一个句号。</p>
<blockquote>
<p>唐晶：装修这么麻烦的事你也自己做啊。<br>贺涵：喜欢，你就有时间。<br>（唐晶听出贺涵的意思了，喜欢你，就有时间。她有点不自在，转头看向屋内。）<br>唐晶：叫我去费心装修我可没有心思，这沙发这布局真是不错。<br>贺涵：如果喜欢的话，你可以搬进来住。如果你不喜欢，我可以重新改。<br>唐晶：（没有说话，眼神中闪烁着感动）你不是在开玩笑吧，我们不是没有一块住过，不是都觉得有点糟糕吗？<br>贺涵：那是几年前，我们各自的事业都在上升阶段嘛。现在我们虽然依然很忙，但是我们自己相对稳定下来了。<br>唐晶：我怕，万一要是再出什么问题，会不会又是关系的调整和疏远。<br>贺涵：首先，我已经辞职了，现在我们不再是上下级的关系，至少工作上的矛盾不会再影响我们俩了。<br>唐晶：（惊讶）什么你辞职了？！这是多好的工作机会啊！为了我……（欲言又止）（紧张）你，你知道我，我现在住的地方离公司挺近的，而且我……<br>贺涵：（眼神里有一些失望）唐晶啊，你这样的职场女强人怎么也变得战战兢兢的了，你面对工作的时候可不是这么犹豫不决的啊。<br>唐晶：（意识到自己的失态）我可能有点紧张兮兮吧。<br>贺涵：我也没要求你立马就搬过来住，你可以好好再考虑考虑。房子又不是面包有保质期，在这儿就在这儿，也不会过期，你考虑好了随时都可以来。<br>唐晶：（紧张地摸了摸自己的胸口）你说你，为了我辞职，为了我悄悄弄好房子，为了我做这么多事情，就像高考前我爸妈明明要离婚的，为了我高考，暂时不离了。（生气，情绪高涨）你说我敢考不好吗？<br>贺涵：（表情平缓下来）还有最后一件事情要你决定。<br>唐晶：（紧张）什么？<br>贺涵：鳕鱼是要煎着吃还是蒸着吃？<br>（听到这儿，唐晶送了一口气。笑了。）</p>
</blockquote>
<p>这里贺涵其实是在和唐晶谈论一件大事，希望彼此更亲近。我看的几集中，确实感觉贺涵和唐晶不像是情侣，总觉得缺了点什么，但又说不上来。看完这段对话后，我仔细的再回想了一下，为什么会不像情侣？是因为他们缺乏一种情侣中的亲密感，那为什么会这样？</p>
<p>看得出唐晶很爱贺涵，但是她同时又害怕进一步做出尝试，害怕两个人走得太近，她总是在内心深处与贺涵保持着一定距离。面对贺涵的真心，唐晶并非感受不到，但是她依然选择了<strong>逃避</strong>，比起迎头直上，她更喜欢像鸵鸟一样的把头埋进沙子里，比起抒发感情，她更喜欢压抑自己的情感。</p>
<p>我想说的是自己，子君的控制欲我能一眼就看出来，为什么我却一直都没怎么看出来唐晶的<strong>习惯性逃避</strong>？其实我之前也有控制欲，但在有一段感情中，当对方把控制欲和不信任感强加在我身上时，我非常反感，当时毅然分手，至今也不后悔。而我，看不到唐晶的习惯性逃避，是因为这样子的毛病至今都在我身上，而且之前我都不觉得这有什么错，我总觉得太麻烦了太麻烦了，能躲则躲，能不知道就不知道，这会让我获得自以为是的自在感。</p>
<p>好在，这些都是可以改的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Grace</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">35</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Grace</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
