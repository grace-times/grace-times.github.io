<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="寂静的声音">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="寂静的声音">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="寂静的声音">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>寂静的声音</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">寂静的声音</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/20/Robot Framework + Appium做Android的自动化测试/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/20/Robot Framework + Appium做Android的自动化测试/" itemprop="url">Robot Framework + Appium做Android的自动化测试</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-20T22:59:01+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>环境安装有点麻烦，手生的可以参考。</p>
<h4 id="一、Robot-Framework及基础库安装"><a href="#一、Robot-Framework及基础库安装" class="headerlink" title="一、Robot Framework及基础库安装"></a>一、Robot Framework及基础库安装</h4><p>以下提供一些基础的安装说明，可根据需要选择自己要安装的库。<br>| 序号   | 安装包名                | 安装方法                                     | 下载地址                                     | 备注                               |<br>| —- | ——————- | —————————————- | —————————————- | ——————————– |<br>| 1    | python              | exe文件，直接双击安装                             | <a href="https://www.python.org/download/releases/2.7.8/" target="_blank" rel="noopener">https://www.python.org/download/releases/2.7.8/</a> | 一切的基础，安装路径不能有空格                  |<br>| 2    | setuptools          | 下载ez_setup.py文件，双击                       | <a href="https://pypi.python.org/pypi/setuptools" target="_blank" rel="noopener">https://pypi.python.org/pypi/setuptools</a>  | Python 的套件管理程式                   |<br>| 3    | pip                 | 1、cmd进入ez_setup.py文件目录<br>2、用setuptools安装：easy_install pip | <a href="https://pip.pypa.io/en/latest/index.html" target="_blank" rel="noopener">https://pip.pypa.io/en/latest/index.html</a> | Python 的套件管理程式                   |<br>| 4    | robot framework     | 1、pip install robotframework<br>2、源码：python setup.py install<br>3、exe文件，直接双击安装 | <a href="https://pypi.python.org/pypi/robotframework" target="_blank" rel="noopener">https://pypi.python.org/pypi/robotframework</a>    <br><a href="https://github.com/robotframework/robotframework" target="_blank" rel="noopener">https://github.com/robotframework/robotframework</a> | robot framework本身                |<br>| 5    | wxPython            | exe文件，直接双击安装                             | <a href="http://wxpython.org/download.php#stable" target="_blank" rel="noopener">http://wxpython.org/download.php#stable</a>  | 支撑Ride的运行库                       |<br>| 6    | robotframework-ride | 1、pip install robotframework-ride<br>2、源码：python setup.py install<br>3、exe文件，直接双击安装 | <a href="https://pypi.python.org/pypi/robotframework-ride" target="_blank" rel="noopener">https://pypi.python.org/pypi/robotframework-ride</a> | ride                             |<br>| 7    | selenium2library    | 1、pip install robotframework-selenium2library<br>2、源码：python setup.py install<br>3、exe文件，直接双击安装 | <a href="https://pypi.python.org/pypi/robotframework-selenium2library" target="_blank" rel="noopener">https://pypi.python.org/pypi/robotframework-selenium2library</a> | selenium2测试库，基于webdriver驱动       |<br>| 8    | cx_Oracle           | exe文件，直接双击安装                             | <a href="http://sourceforge.net/projects/cx-oracle/files/" target="_blank" rel="noopener">http://sourceforge.net/projects/cx-oracle/files/</a> | 连接oracle用的(支持第9步)                |<br>| 9    | databaselibrary     | 1、pip install robotframework-databaselibrary<br>2、源码：python setup.py install | <a href="https://github.com/franz-see/Robotframework-Database-Library" target="_blank" rel="noopener">https://github.com/franz-see/Robotframework-Database-Library</a> | DB库                              |<br>| 10   | requests            | pip install requests                     | <a href="https://pypi.python.org/pypi/requests" target="_blank" rel="noopener">https://pypi.python.org/pypi/requests</a>    | 支持第11步，否则RF引入RequestsLibrary库会报错 |<br>| 11   | RequestsLibrary     | pip install -U robotframework-requests   | <a href="https://github.com/bulkan/robotframework-requests" target="_blank" rel="noopener">https://github.com/bulkan/robotframework-requests</a> | http request库                    |<br>| 12   | AppiumLibrary       | 1、pip install robotframework-appiumlibrary<br>2、源码：python setup.py install<br>3、exe文件，直接双击安装 | <a href="https://github.com/serhatbolsu/robotframework-appiumlibrary" target="_blank" rel="noopener">https://github.com/serhatbolsu/robotframework-appiumlibrary</a> | Appium测试库                        |</p>
<h4 id="二、Android环境配置"><a href="#二、Android环境配置" class="headerlink" title="二、Android环境配置"></a>二、Android环境配置</h4><p>1、JDK安装与配置<br>2、Android SDK与配置<br>请自行百度。网上有很多安装配置教程</p>
<p><strong>获取APK packagename和activityname</strong><br>cmd进入命令终端，执行 aapt dump badging  your.apk，就会看到对应的Package名，Activity名。<br>(注意：your.apk要包含电脑上的完整路径名，如 aapt dump badging d:\自行车码表.apk)</p>
<h4 id="三、Appium安装和配置"><a href="#三、Appium安装和配置" class="headerlink" title="三、Appium安装和配置"></a>三、Appium安装和配置</h4><p>NodeJs：<a href="https://nodejs.org/en/" target="_blank" rel="noopener">https://nodejs.org/en/</a> 最好装稳定版，安装之后检测下是否安装OK<br>Appium： <a href="http://appium.io/" target="_blank" rel="noopener">http://appium.io/</a><br>安装appium之前必须先装 nodejs，Appium 依赖 .net framework<br>设置安卓版本. 根据设备的Android版本设置即可。<br>装完后 介绍一个检查命令 <strong>appium-doctor</strong></p>
<h4 id="四、RIDE连接设备并使用"><a href="#四、RIDE连接设备并使用" class="headerlink" title="四、RIDE连接设备并使用"></a>四、RIDE连接设备并使用</h4><p>Open Application    <a href="http://127.0.0.1:4723/wd/hub" target="_blank" rel="noopener">http://127.0.0.1:4723/wd/hub</a>    platformName=Android    platformVersion=4.4    appPackage=com.sf.wmsrf    appActivity=com.sf.wmsrf.activity.WelcomeActivity    deviceName=127.0.0.1:21503    unicodeKeyboard=True    resetKeyboard=True        </p>
<p>如何获取deviceName？adb devices即可。</p>
<p>连接真机或者虚拟机，我这里使用的是逍遥模拟器，这里有几个问题要注意。<br>在用Appium连接设备时，要确认Android的版本<br>用adb连接设备时，要确认SDK的版本号与模拟器的adb版本一致<br>设备要开启USB调试，我这里是设置–&gt;关于平板–&gt;连续多次点击版本号，唤醒开发者选项–&gt;开发者选项–&gt;勾选USB调试。</p>
<h4 id="补充一：页面元素统一管理"><a href="#补充一：页面元素统一管理" class="headerlink" title="补充一：页面元素统一管理"></a>补充一：页面元素统一管理</h4><p>1、安装PyYAML<br>| 序号   | 安装包名    | 安装方法                       | 下载地址                                 | 备注      |<br>| —- | ——- | ————————– | ———————————— | ——- |<br>| 1    | Yaml对象库 | 源码：python setup.py install | <a href="https://pypi.python.org/pypi/PyYAML/" target="_blank" rel="noopener">https://pypi.python.org/pypi/PyYAML/</a> | Yaml对象库 |<br>2、替换文件,</p>
<p>D:\Python27\Lib\site-packages\AppiumLibrary\locators\elementfinder.py</p>
<p>主要是补充和修改了以下函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">def _yaml_locator(self,elementStr):</span><br><span class="line">    # if(elementStr.startswith(&quot;id&quot;) or elementStr.startswith(&quot;name&quot;) or elementStr.startswith(&quot;xpath&quot;)):</span><br><span class="line">    # locator=elementStr</span><br><span class="line">    locator=None</span><br><span class="line">    listfile = os.listdir(os.environ[&quot;RFS_DIR&quot;])</span><br><span class="line">    # elementStr=elementStr.decode(&apos;utf8&apos;)</span><br><span class="line">    for file in listfile:</span><br><span class="line">        pattern = re.compile(r&apos;[^.]*\.yaml$&apos;)</span><br><span class="line">        if( pattern.match(file)):</span><br><span class="line">            f = open(os.environ[&quot;RFS_DIR&quot;]+&quot;\\&quot;+file)</span><br><span class="line">            s = yaml.load(f)</span><br><span class="line">            if(s.has_key(elementStr)):</span><br><span class="line">                locator=s[elementStr]</span><br><span class="line">        if(locator!=None):</span><br><span class="line">            break</span><br><span class="line">    return locator</span><br><span class="line">	</span><br><span class="line">def _parse_locator(self, locator):</span><br><span class="line">    prefix = None</span><br><span class="line">	</span><br><span class="line">	#l = YamlFile()</span><br><span class="line">    # or locator.startswith(&quot;name&quot;) or locator.startswith(&quot;xpath&quot;))</span><br><span class="line">    if locator.startswith(&quot;id&quot;) \</span><br><span class="line">        or locator.startswith(&quot;name&quot;) \</span><br><span class="line">        or locator.startswith(&quot;xpath&quot;) \</span><br><span class="line">        or locator.startswith(&quot;accessibility_id&quot;):</span><br><span class="line">        criteria = locator</span><br><span class="line">    else:</span><br><span class="line">        locator = self._yaml_locator(locator)</span><br><span class="line">		</span><br><span class="line">    if not locator.startswith(&apos;//&apos;):</span><br><span class="line">        locator_parts = locator.partition(&apos;=&apos;)</span><br><span class="line">        if len(locator_parts[1]) &gt; 0:</span><br><span class="line">            prefix = locator_parts[0].strip().lower()</span><br><span class="line">            criteria = locator_parts[2].strip()</span><br><span class="line">    return (prefix, criteria)</span><br></pre></td></tr></table></figure></p>
<p>3、添加环境变量，RFS_DIR，该环境变量对应目录下的yaml文件都会被读取，页面元素名称不可重复。</p>
<h4 id="补充二：Oracle连接"><a href="#补充二：Oracle连接" class="headerlink" title="补充二：Oracle连接"></a>补充二：Oracle连接</h4><ol>
<li>安装cx_Oracle插件（需要与python、oracle、win版本保持一致）<br>我的RFS安装配置中已有，且可用，32位的。</li>
<li>下载oci.dll、oraocci11.dll、oraociei11.dll放入Python相关目录下（D:\Python27\Lib\site-packages）<br>（可以下载相关instantclient102.zip，该zip包中包含）<br>我是从别人的PL/SQL下面copy了一个过来，放在RFS安装配置中，与cx_Oracle匹配<br>配置环境变量：<br>将D:\instantclient_10_2追加到环境变量path中；另外补充：<br>TNS_ADMIN=D:\instantclient_10_2<br>NLS_LANG=SIMPLIFIED CHINESE_CHINA.UTF8</li>
<li>在RF中引入library</li>
<li>使用（Connect To Database Using Custom Params cx_Oracle ‘username’,’password’,’ip:port/servername’）</li>
</ol>
<p>问题一：DLL load failed<br>解决：Python，cx_Oracle，Oracle Instant Client要匹配，包括版本与位数</p>
<p>问题二：ORA-00911: 无效字符<br>解决：SQL语句末尾不要加分号</p>
<h4 id="补充三：MySQL连接"><a href="#补充三：MySQL连接" class="headerlink" title="补充三：MySQL连接"></a>补充三：MySQL连接</h4><h5 id="一-mysqldb安装："><a href="#一-mysqldb安装：" class="headerlink" title="一.mysqldb安装："></a>一.mysqldb安装：</h5><p>方法一：下载MySQL-python-1.2.3.win-amd64-py2.7.exe安装包安装<br>下载地址有：<a href="http://download.csdn.net/download/leechenye/6411185" target="_blank" rel="noopener">http://download.csdn.net/download/leechenye/6411185</a><br>安装完后会在D:\Python27\Lib\site-packages生成两个文件：MySQLdb库<br>方法二：下载MySQL-python-1.2.4b4.tar.gz压缩包，cmd然后输入 python setup.py install即可。</p>
<h5 id="二-pymssql安装："><a href="#二-pymssql安装：" class="headerlink" title="二.pymssql安装："></a>二.pymssql安装：</h5><p>方法一：下载pymysql的.exe安装包安装<br>安装完后会在D:\Python27\Lib\site-packages生成PyMySQL-0.6.2-py2.7.egg库<br>方法二：下载PyMySQL-0.6.2-py2.7.egg压缩包，cmd然后输入 python setup.py install即可。</p>
<p>参考：<a href="http://blog.csdn.net/lishan9133/article/details/7024989" target="_blank" rel="noopener">http://blog.csdn.net/lishan9133/article/details/7024989</a></p>
<h5 id="三-验证是否安装成功：在python-ide里面import-MySQLdb-import-pymysql-没有报错说明安装成功"><a href="#三-验证是否安装成功：在python-ide里面import-MySQLdb-import-pymysql-没有报错说明安装成功" class="headerlink" title="三.验证是否安装成功：在python ide里面import MySQLdb import pymysql 没有报错说明安装成功"></a>三.验证是否安装成功：在python ide里面import MySQLdb import pymysql 没有报错说明安装成功</h5><h5 id="四-RIDE连接、使用："><a href="#四-RIDE连接、使用：" class="headerlink" title="四.RIDE连接、使用："></a>四.RIDE连接、使用：</h5><p>1.先要加载DatabaseLibrary<br>2.连接数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connect To Database Using Custom Params    pymysql    database=&apos;tdsdb&apos;, user=&apos;tdsdb&apos;, password=&apos;7IpnClmkhF&apos;, host=&apos;tdsdb-m.dbsit.sfdc.com.cn&apos;, port=3306</span><br></pre></td></tr></table></figure>
<p>注意：<strong>参数顺序不要打乱</strong></p>
<h5 id="如何支持中文？"><a href="#如何支持中文？" class="headerlink" title="如何支持中文？"></a>如何支持中文？</h5><p>1、连接方式支持UTF-8格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connect To Database Using Custom Params    pymysql    database=&apos;tdsdb&apos;, user=&apos;tdsdb&apos;, password=&apos;7IpnClmkhF&apos;, host=&apos;tdsdb-m.dbsit.sfdc.com.cn&apos;, port=3306,charset=&apos;utf8&apos;</span><br></pre></td></tr></table></figure>
<p>2、最好将SQL语句进行下处理，转成UTF-8格式<br>补充MyLibrary.py</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(&quot;utf-8&quot;)</span><br><span class="line"></span><br><span class="line">    def decode_data_utf8(self,*olddata):</span><br><span class="line">        data = &quot;&quot;+str(olddata[0])</span><br><span class="line">        return data.decode(&apos;utf8&apos;)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/20/Python + Appium一个简单的Demo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/20/Python + Appium一个简单的Demo/" itemprop="url">Python + Appium一个简单的Demo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-20T22:55:24+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Python-Appium一个简单的Demo"><a href="#Python-Appium一个简单的Demo" class="headerlink" title="Python + Appium一个简单的Demo"></a>Python + Appium一个简单的Demo</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">__author__ = <span class="string">'01106066'</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> appium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> HTMLTestRunner</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">packageName = <span class="string">'com.tencent.mm'</span></span><br><span class="line">activityName=<span class="string">'com.tencent.mm.ui.LauncherUI'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AutoTestDemo</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></span><br><span class="line"></span><br><span class="line">        desired_caps = &#123;&#125;</span><br><span class="line">        desired_caps[<span class="string">'platformName'</span>] = <span class="string">'Android'</span></span><br><span class="line">        desired_caps[<span class="string">'platformVersion'</span>] = <span class="string">'4.4'</span></span><br><span class="line">        desired_caps[<span class="string">'deviceName'</span>] = <span class="string">'127.0.0.1:21503'</span></span><br><span class="line">        desired_caps[<span class="string">'appPackage'</span>] = packageName</span><br><span class="line">        desired_caps[<span class="string">'appActivity'</span>] = activityName</span><br><span class="line">        self.driver = webdriver.Remote(<span class="string">'http://localhost:4723/wd/hub'</span>, desired_caps)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_login</span><span class="params">(self)</span>:</span></span><br><span class="line">        driver = self.driver</span><br><span class="line">        driver.find_element_by_id(<span class="string">'com.tencent.mm:id/czy'</span>).click()</span><br><span class="line">        self.assertEqual(driver.find_element_by_id(<span class="string">'com.tencent.mm:id/jv'</span>).text,<span class="string">'手机号登录'</span>,<span class="string">'进入登录界面失败'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.driver.quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    suite = unittest.TestSuite()</span><br><span class="line">    suite.addTest(AutoTestDemo(<span class="string">'test_login'</span>))</span><br><span class="line">    filename = <span class="string">'D:\\app.html'</span></span><br><span class="line">    fb = file(filename, <span class="string">'wb'</span>)</span><br><span class="line">    runner = HTMLTestRunner.HTMLTestRunner(stream=fb, title=<span class="string">'AutoTestDemoReport'</span>, description=<span class="string">'AutoTestDemo'</span>)<span class="comment">#使用HTMLTestRunner配置参数，输出报告路径、报告标题、描述</span></span><br><span class="line">    <span class="comment"># runner.run(suite)</span></span><br><span class="line">    result =  runner.run(suite)</span><br><span class="line">    <span class="keyword">print</span> result.success_count  <span class="comment">#运行成功的数目</span></span><br><span class="line">    <span class="keyword">print</span> result.testsRun     <span class="comment">#运行测试用例的总数</span></span><br><span class="line">    <span class="keyword">print</span> result.failure_count  <span class="comment">#运行失败的数目</span></span><br><span class="line">    fb.close()</span><br></pre></td></tr></table></figure>
<h4 id="断言方式汇总"><a href="#断言方式汇总" class="headerlink" title="断言方式汇总"></a>断言方式汇总</h4><p>自动化测试中寻找元素并进行操作，但光进行操作可能还不够，有时候也需要对预期结果进行判断。</p>
<p>这里介绍几个常用断言的使用方法，可以一定程度上帮助大家对预期结果进行判断。</p>
<p>这里介绍以下几个断言方法：<br>assertEqual<br>assertNotEqual<br>assertTrue<br>assertFalse<br>assertIsNone<br>assertIsNotNone</p>
<p>（一）assertEqual 和 assertNotEqual<br>assertEqual：如两个值相等，则pass<br>assertNotEqual：如两个值不相等，则pass<br>下面看下具体使用方法</p>
<pre><code class="python">self.driver.find_element_by_xpath(<span class="string">"//android.widget.LinearLayout[1]/android.support.v7.app.ActionBar.e[2]"</span>).click()<span class="comment">#切到超模25tab</span>
sleep(<span class="number">3</span>)
self.assertEqual(self.driver.find_element_by_id(<span class="string">'com.boohee.secret:id/tv_title'</span>).text,<span class="string">u'超模25'</span>,<span class="string">'切到超模25tab失败'</span>)
</code></pre>
<p>（1）这边是通过id（com.boohee.secret:id/tv_title）获取它的text值，与预期“超模25”对比，如相等则pass；不相等则fail。<br>（2）后面的“切到超模25tab失败”是fail时需要打印的信息，可写可不写。<br>断言assertNotEqual反着用就可以了。</p>
<p>（二）assertTrue和assertFalse<br>assertTrue：判断bool值为True，则pass<br>assertFalse：判断bool值为False，则Pass<br>下面看下具体使用方法</p>
<pre><code class="python">self.driver.find_element_by_xpath(<span class="string">"//android.widget.LinearLayout[1]/android.widget.TextView[1]"</span>).click()<span class="comment">#点击登录入口</span>
sleep(<span class="number">2</span>)
self.driver.find_element_by_xpath(<span class="string">"//android.widget.LinearLayout[1]/android.widget.EditText[1]"</span>).send_keys(<span class="string">"testq1"</span>)<span class="comment">#输入用户名</span>
sleep(<span class="number">2</span>)
self.assertTrue(self.find_element_by_id(<span class="string">'com.boohee.secret:id/btn_login'</span>).is_enabled(),<span class="string">'未输密码登录按钮为不可点状态,Fail'</span>)
</code></pre>
<p>（1）这边是通过id（com.boohee.secret:id/btn_login）获取它的激活状态，如为True则pass；反之则fail。<br>（2）后面的“未输密码登录按钮为不可点状态”是fail时需要打印的信息，可写可不写。<br>断言assertFalse反着用就可以了。</p>
<p>（三）assertIsNone和assertIsNotNone<br>assertIsNone：不存在，则pass<br>assertIsNotNone：存在，则pass<br>下面看下具体使用方法</p>
<pre><code class="python">self.driver.find_element_by_xpath(<span class="string">"//android.widget.LinearLayout[1]/android.widget.TextView[1]"</span>).click()<span class="comment">#点击登录入口</span>
sleep(<span class="number">2</span>)
self.driver.find_element_by_xpath(<span class="string">"//android.widget.LinearLayout[1]/android.widget.EditText[1]"</span>).send_keys(<span class="string">"testq1"</span>)<span class="comment">#输入用户名</span>
sleep(<span class="number">2</span>)
self.driver.find_element_by_xpath(<span class="string">"//android.widget.LinearLayout[2]/android.widget.EditText[1]"</span>).send_keys(<span class="string">"boohee"</span>)<span class="comment">#输入密码</span>
sleep(<span class="number">2</span>)
self.driver.find_element_by_xpath(<span class="string">"//android.widget.LinearLayout[1]/android.widget.Button[1]"</span>).click()<span class="comment">#点击登录按钮</span>
sleep(<span class="number">10</span>)
self.assertIsNotNone(self.driver.find_element_by_id(<span class="string">'com.boohee.secret:id/tv_edit_profile'</span>),<span class="string">'无编辑资料按钮,登录失败,Fail'</span>)
</code></pre>
<p>（1）这边是通过寻找id（com.boohee.secret:id/tv_edit_profile）的元素是否存在，如存在则pass；不存在则fail。<br>（2）后面的“无编辑资料按钮,登录失败,Fail”是fail时需要打印的信息，可写可不写。<br>断言assertIsNone反着用就可以了。</p>
<p>总结：这边的断言虽然不能像人工判断预期结果那样准确，但合理灵活地运用，对于重要节点加上断言也是具有一定判断预期的效果的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/20/MySQL-java连接被拒绝解决方案/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/20/MySQL-java连接被拒绝解决方案/" itemprop="url">MySQL java连接被拒绝的解决方案（Access denied）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-20T22:51:15+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="问题背景"><a href="#问题背景" class="headerlink" title="问题背景"></a>问题背景</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//系统运行出现错误：</span><br><span class="line">java.sql.SQLException: Access denied for user &apos;root&apos;@&apos;*** (using password: YES)</span><br></pre></td></tr></table></figure>
<p>MySQL服务器部署在CentOS上，错误中被我隐掉的是我的主机名<br><img src="/uploads/photo/2018/4f1b78e0-1190-4a9b-8eaa-9c9bc4fd138c.png!large" alt=""></p>
<h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><ol>
<li><p>先在命令行登录</p>
<figure class="highlight plain"><figcaption><span>-u root -p ```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2. 给指定的用户赋予权限</span><br><span class="line">  ``` GRANT ALL PRIVILEGES ON *.* TO &apos;leechdb&apos;@&apos;%&apos; IDENTIFIED BY &quot;leechdb&quot; ;</span><br></pre></td></tr></table></figure>
<p>IDENTIFIED BY后面的是对应用户的密码</p>
</li>
<li><p>刷新</p>
<figure class="highlight plain"><figcaption><span>privileges; ```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  ![](/uploads/photo/2018/cf180adb-97c5-4cfd-97a6-d3c88eba104d.png!large)</span><br><span class="line"></span><br><span class="line">### 方案二</span><br><span class="line">jdbc.properties文件配置中username关键字与其他的有冲突，最好自己定义下</span><br><span class="line">参考：https://www.cnblogs.com/wozixiaoyao/p/5751108.html</span><br><span class="line"></span><br><span class="line">我的spring-config-datasource.xml 文件</span><br><span class="line">![](/uploads/photo/2018/64f4d26b-d16f-4585-a099-2b26956b0b80.png!large)</span><br><span class="line">我的jdbc.properties文件</span><br><span class="line">![](/uploads/photo/2018/3069ad95-6f1c-4199-a5c7-79925eec6d2e.png!large)</span><br><span class="line"></span><br><span class="line">### 方案三</span><br><span class="line">在尝试了前面两种方案都不行的情况下，在Navicat下执行以下动作</span><br></pre></td></tr></table></figure>
<p>SELECT * FROM mysql.user WHERE USER=’root’ ;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">结果如下：</span><br><span class="line">![](/uploads/photo/2018/0c4c626d-4a79-4efd-b667-cf977c923cad.png!large)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">``` sql</span><br><span class="line"> GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;192.168.107.61&apos; IDENTIFIED BY &apos;root&apos;;</span><br><span class="line"> FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>按理应当如下：<br><img src="/uploads/photo/2018/a37fa4fc-cf29-40bb-ac28-1c4b98074000.png!large" alt=""></p>
<p>然而，不知道什么原因，并没看到最后那条数据<br>于是，就有了一个暴力的方法：<strong>直接insert一条数据，问题解决</strong>。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/20/谈谈WEB性能测试（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/20/谈谈WEB性能测试（一）/" itemprop="url">谈谈WEB性能测试（一）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-20T22:30:17+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="谈谈WEB性能测试（一）"><a href="#谈谈WEB性能测试（一）" class="headerlink" title="谈谈WEB性能测试（一）"></a>谈谈WEB性能测试（一）</h3><p><strong>性能测试</strong>: 通过模拟生产运行的业务压力量和使用场景组合，测试系统在峰值的情况下各项性能指标是否满足生产性能要求。<br><strong>特点</strong>：负载逐渐增加时，根据系统<strong>各项性能指标的变化情况</strong>，获得系统系统处理能力的极限，以及处于压力情况下稳定运行的能力。</p>
<h4 id="一、性能测试应关注些什么"><a href="#一、性能测试应关注些什么" class="headerlink" title="一、性能测试应关注些什么"></a>一、性能测试应关注些什么</h4><p>响应时间<br>服务器资源使况是否合理<br>应用服务器和数据库资源使用是否合理<br>系统能否实现扩展<br>系统最多支持多少用户访问、系统最大业务处理量是多少<br>系统性能可能存在的瓶颈在哪里<br>更换那些设备可以提高性能<br>系统能否支持7×24小时的业务访问</p>
<h4 id="二、性能指标介绍"><a href="#二、性能指标介绍" class="headerlink" title="二、性能指标介绍"></a>二、性能指标介绍</h4><ul>
<li>用户数<ul>
<li>用户数是指在应用系统中注册的所有系统用户。</li>
<li>该用户数取决于系统应用范围和业务范围，可以通过统计应用系统数据库中用户登记表取得。</li>
</ul>
</li>
<li>在线用户数<ul>
<li>在线用户数是指同时登录应用系统的用户数量。</li>
<li>该数据可通过检查系统应用与数据库连接取得。</li>
<li>对于已投产系统，该数量一般通过系统跟踪监控获取。</li>
<li>新投产系统通过经验值估算。</li>
</ul>
</li>
<li>并发用户数<ul>
<li>应用系统可支持的并发用户数通常反映系统的容量，即系统的处理能力情况。</li>
<li>并发用户数是指系统运行期间同一时刻进行业务操作的用户数量。</li>
<li>该数量取决于用户操作习惯、业务操作间隔和单笔交易的响应时间。</li>
<li>使用频率较低的应用系统并发用户数一般为在线用户数的5%左右。</li>
<li>使用频率较高的应用系统并发用户数一般为在线用户数的10%左右。</li>
</ul>
</li>
<li>交易<ul>
<li>交易分为业务层面和技术层面两种定义。</li>
<li>业务层面交易是指完成一次完整的业务操作，如进行一次查询、转账。</li>
<li>技术层面交易是指进行一次应用程序至应用程序、或者应用程序至数据库的系统操作。</li>
<li>一般的一笔业务交易由多笔技术交易组成。根据业务交易的复杂度和系统应用架构的不同，其比例大致为1：2  – 1：10</li>
</ul>
</li>
<li>响应时间<ul>
<li>响应时间指的是从开发端发起一个请求开始，到客户端接收到从服务器端返回的响应结束，这个过程所耗费的时间。<br><img src="/uploads/photo/2017/f9919882-c009-4137-90c0-93996a476e70.png!large" alt=""></li>
</ul>
</li>
<li>交易成功率<ul>
<li>交易成功率指的是一段时间内成功的交易数在总交易数中所占的比例，金融行业应用系统一般要求在99%以上。</li>
</ul>
</li>
<li>吞吐量<ul>
<li>吞吐量是指单位时间内系统处理的客户请求的数量，直接体现应用系统的性能承载能力。<br><img src="/uploads/photo/2017/42db6951-1f4b-47d5-a2dc-bd8b4de4af9f.png!large" alt=""></li>
</ul>
</li>
<li>TPS与HPS<ul>
<li>TPS：Transaction per second-指应用系统每秒钟处理完成的交易数量,是估算应用系统性能的重要依据。<ul>
<li>一般而言，评价系统性能均以每秒完成的技术交易的数量来衡量。</li>
<li>系统整体处理能力取决于处理能力最低模块的TPS值。</li>
</ul>
</li>
<li>HPS：Hit per second 每秒点击次数<ul>
<li>指一秒钟的时间内用户对web页面的链接、提交按钮等点击总和。</li>
<li>HPS一般与TPS成正比关系，是B/S系统中非常重要的性能指标之一。</li>
</ul>
</li>
</ul>
</li>
<li>资源利用率<ul>
<li>资源利用率是指系统在负载运行期间，数据库服务器、应用服务器、web服务器的CPU、内存、硬盘、网络带宽的使用率。</li>
<li>据经验，低于20%的利用率为资源空闲，20%–60%的使用率为资源使用稳定，60%–80%的使用率表示资源使用饱和，超过80%的资源使用率必须尽快进行资源调整与优化。</li>
</ul>
</li>
<li>其他指标<ul>
<li>在性能测试过程中还有大量与软件产品或硬件设备相关的测算指标；</li>
<li>行业相关指标</li>
</ul>
</li>
</ul>
<h4 id="三、性能测试类型"><a href="#三、性能测试类型" class="headerlink" title="三、性能测试类型"></a>三、性能测试类型</h4><ul>
<li>负载测试(Load Test)：<br>通过逐步增加系统负载，测试系统性能的变化，并最终确定在满足性能指标的情况下，系统所能承受的最大负载量，找出性能测试拐点的测试。 </li>
<li>压力测试(Stress Test)：<br>通过逐步增加系统负载，测试系统性能的变化，并通过确定一个系统的瓶颈或者不能接受的性能点，并以此来获得系统能够提供的最大服务级别的测试。<br>压力测试是一种特定类型的负载测试。</li>
<li>混合交易负载测试：<br>混合场景，是模拟系统实际运行环境，对各种业务场景按一定比例组合，在一定并发量下进行的负载测试，以了解系统在多业务操作场景下，不同业务配比的实际性能表现，并找出影响系统性能的单场景以进行调优。</li>
<li>稳定性测试：<br>通常是采用系统稳定运行情况下能够支持的最大并发用户数或者日常运行用户数，持续执行一段时间业务，通过综合分析交易执行指标和资源监控指标来确定系统处理最大工作量强度性能的过程。<br>稳定性测试可以反映出系统的在长时间的压力下性能瓶颈，例如内存泄漏等。 </li>
<li>大数据量测试：<br>实时大数据量：模拟用户工作时的实时大数据量，主要目的是测试用户较多或者某些业务产生较大数据量时，系统能否稳定地运行。<br>极限状态下的测试：主要是测试系统使用一段时间即系统累积一定量的数据时，能否正常地运行业务。<br>针对系统存储、统计查询等业务而言，是专项的大数据量的测试。</li>
</ul>
<h4 id="四、性能测试流程"><a href="#四、性能测试流程" class="headerlink" title="四、性能测试流程"></a>四、性能测试流程</h4><p>1、测试计划</p>
<ul>
<li>性能需求调研：性能指标，业务模型，数据规模，场景类型</li>
<li>熟悉被测系统：业务量，系统架构，系统拓扑结构，其他细节</li>
</ul>
<p>2、测试设计</p>
<ul>
<li>性能测试方案：测试目标，测试类型，用例场景，测试策略</li>
<li>性能测试计划</li>
<li>性能测试用例</li>
</ul>
<p>3、测试开发</p>
<ul>
<li>性能测试环境搭建：机器申请，软件安装，应用部署，工具部署</li>
<li>性能脚本开发</li>
<li>测试数据：存量数据，业务数据</li>
</ul>
<p>4、测试执行</p>
<ul>
<li>性能场景执行：基准场景，负载测试等等</li>
<li>资源监控：业务指标，系统指标，应用指标，前端指标</li>
<li>数据收集：指标资源，修改记录，以及问题追踪列表及解决办法</li>
</ul>
<p>5、测试评估</p>
<ul>
<li>性能问题分析</li>
<li>性能测试报告</li>
<li>性能调优报告</li>
</ul>
<p><strong>测试环境准备</strong>：测试环境与生产的实际环境是有较大的不同，测试环境的网络、计算机硬件软件都无法做到和生产完全相一致。测试环境必须要满足软件运行的最低要求；选用与被测软件相一致的操作系统和软件平台；营造相对独立的测试环境。<br><img src="/uploads/photo/2017/e09cf89c-f38a-4285-b16d-44e04d79472a.png!large" alt=""></p>
<p><strong>存量数据估算</strong>：具体需要多少数据量可以根据客户数据库中的数据数量进行模拟，否则测试结果会与生产环境实际情况有一定的差距</p>
<h4 id="五、性能测试文档"><a href="#五、性能测试文档" class="headerlink" title="五、性能测试文档"></a>五、性能测试文档</h4><p>1、测试计划：进度安排<br>2、测试方案：测试策略<br>3、测试记录：问题追踪<br>4、测试报告：质量依据</p>
<h4 id="六、性能测试工具"><a href="#六、性能测试工具" class="headerlink" title="六、性能测试工具"></a>六、性能测试工具</h4><ol>
<li>压力工具：Jmeter，LoadRunner，Http load等</li>
<li>监控工具：<ol>
<li>系统级：Nmon/Balant/Linux Command</li>
<li>应用级：Jvisualvm/Jconsole/Linux Command?JMC</li>
<li>数据库级：MONyog/AWR/Mysq慢日志查询</li>
<li>前端级：HttpWatch/Fiddle/Firebug</li>
</ol>
</li>
<li>分析工具<ol>
<li>线上：Jconsole/Jvisualvm</li>
<li>线下：HeapAnalyzer/MAT</li>
</ol>
</li>
<li>其他辅助工具</li>
</ol>
<h4 id="七、性能监控"><a href="#七、性能监控" class="headerlink" title="七、性能监控"></a>七、性能监控</h4><ul>
<li>部分一<ul>
<li>主机层：CPU，内存，磁盘，网络</li>
<li>中间件层：堆内存，线程，JDBC连接数，中间件连接数</li>
<li>代码层：方法耗时，方法调用频度，SQL执行效率</li>
<li>日志曾：异常日志，应用调用</li>
<li>前端层：网络时间，页面加载时间</li>
</ul>
</li>
<li>部分二<ul>
<li>资源指标：CPU使用率，内存使用率，IO使用情况，网络情况</li>
<li>业务指标：TPS，并发用户数，响应时间，事务成功率</li>
<li>应用指标：堆内存使用率，非堆内存使用率，中间件连接数，JDBC连接数，SQL执行效率/锁，队列长度</li>
<li>前端指标：页面加载时间，网络时间</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/13/得到周例会——拆解得到团队中的几个重大失误/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/13/得到周例会——拆解得到团队中的几个重大失误/" itemprop="url">从得到的周例会所能想到的</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-13T23:26:29+08:00">
                2018-03-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今日下班路上看到得到的周例会，这一期的题目很有意思，“拆解得到团队工作中的几个重大失误”。一般人会觉得公司的周例会很没意思，作为得到的深度用户，这一期的周例会还是挺有感触的。</p>
<p>在此之前，我想先说一下得到的周例会，每周二晚上八点，罗振宇，脱不花和快刀青衣会向内部员工组织一次公司的周例会，这个周例会会在得到APP上同步直播，所有得到的用户都可以看到。那么，为什么得到会将内部的例会公开给所有用户呢？</p>
<p>现在这个时代，人与人的分工协作是一切繁荣的原因。分工其中最好的品德不是你优秀，而是你提供确定性。透明其实就是提供确定性，就是我不跟你玩什么默契啊，你猜猜看啊之类的，我怎么想就怎么说，我把我所有的意见，态度，观点，方法全部摆在桌面上。尤其是一家公司跟外部协调事务复杂度极高的时候。 —— 罗振宇</p>
<p>那么，这些“重大失误”到底是什么呢？以日活人数与日使用人数起个头。</p>
<p>可能做互联网的人会更清楚这几个概念，注册用户数是完成注册的用户数量，活跃用户数就是起码能戳进去APP一下的用户数量，日活人数就是日活跃用户数。那么，还有一个日使用人数，日使用人数与日活人数有什么不同呢？日使用人数统计的是那些真正使用了产品的人数，不同的产品会有不同的统计方式，比如使用了多长时间等等。得到目前的注册用户数是1750万，日活人数为100万，日使用人数是80万。也就是说，对于日活人数与日使用人数，得到每天的统计都有20%的差异。</p>
<p>第一层问题是：</p>
<p>这个20%的差异是如何产生的？<br>这个20%的差异是否可以优化？如果可以，哪些操作可以优化？如果不行，那这就是个统计口径的问题，如果是统计口径的问题，那为什么还需要日活人数这个数据呢？ —— 脱不花</p>
<p>关于这方面数据的统计，业内普遍都是使用的日活人数而非日使用人数，日活人数的数据会更好看一些。为什么脱不花会关注这两个数据的差异呢？也是缘于她个人的一段经历，前几天她看到一家欧洲的做音乐APP的公司，这家公司马上要上市，所以公布了报表，那家公司的年报中有一句话大意是这样的。</p>
<p>别的应用会把打开这个动作视为活跃用户（也就是戳进去一下），我们统计这个指标的方式是用户必须真实的听音乐多少秒之后，我们才认为这是一个真实的用户。</p>
<p>第二层问题是：</p>
<p>我们有一个问题在这里，这里有一个20%的差异，它是一个问题，但是，我们持续很长时间没有人去解决这个问题，也没有人推动解决这个问题。 —— 脱不花</p>
<p>问题摆在那里，而我们却视而不见，这就是脱不花认为的得到团队的重大失误，虽然它眼下并没有带来多少实质性的损失，但这是个性质问题，是一个不好的苗头，不利于公司长期的发展。</p>
<p>为什么我们会对问题视而不见呢？脱不花认为，因为我们对自己不诚实，日活百万的APP，这拿出去多好听，能满足团队的虚荣心，但是团队的目标不应是证明自己牛，而是要服务好它的用户。</p>
<p>关于脱不花对于失误的反思，我也有自己的想法。</p>
<p>一是，“与我有关”的心态。她看到那家公司年报中的那句话立马就想到自己的公司和团队，想到自己的产品，并迅速做出反思，采取行动。看似是别人把她给一下子点醒，在我看来，实则是她把产品放在心上，足够的用心才能被点通，足够的用心才会去想“这个东西与我有什么关系”，所谓的视而不见或者麻木不仁，其实就是觉得“与我无关”，这其实是非常不好的，“与我无关”的心态，会让我们错过很多很多东西，所以生活中要多去想想，这个东西跟我有什么关系，生活的智慧，也就这么来的。</p>
<p>二是，要对自己诚实。这一点要做到并不容易。比如说，社会上有一种人，明明喜欢钱苦于没有钱，于是就发表“钱不是万能的”，“有钱人也未必幸福”之类的文章，我先不说这个观点如何，事实是钱大多数时候还是个好东西吧？是一种自由的手段吧？承认自己喜欢钱有那么难吗？坦然的面对自己，目前有什么，想要什么，这样才能更好的追求自己想要的。如果自己都骗自己，那要如何往前走？</p>
<p>三是，提负面意见不带情绪。脱不花全程都是非常平静的谈论这个问题，就事论事，出现问题并不是一味的去归责，而是想着如何解决这个问题。这一点其实非常值得借鉴，提负面意见并不是为了指责你没做好，而是为了更好的认识到问题，从而去解决问题。</p>
<p>这一期的周例会挺精彩的，不妨去看看。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/27/红海行动/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/27/红海行动/" itemprop="url">红海行动</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-27T23:15:56+08:00">
                2018-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>回深的第一天与朋友去电影院看了《红海行动》，整体来说还是挺满意的，这部电影节奏紧张，视觉效果和音响效果都还可以，两个多小时下来，可谓高潮迭起，有的人会觉得很“燃”，只是我实在是有点受不了其中多处太过血腥的场面，更多的是感受到战争的残酷吧。</p>
<h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><p>故事以保护中国侨民利益，与恐怖势力作斗争为背景。</p>
<p>开场，索马里海域外，中国商船遭遇劫持，部分船员被海盗杀害，其他人沦为俘虏。蛟龙突击队沉着应对，潜入商船进行突袭，成功解救全部人质。狙击手罗星在追击海盗时不幸被击中脊柱神经，欠缺的位置由顾顺（黄景瑜饰）替代。</p>
<p>返航途中，非洲北部伊维亚共和国政局动荡，恐怖组织连同叛军攻入首都，当地华侨面临危险。海军战舰接到上级命令改变航向，前往执行撤侨任务。蛟龙突击队八人，杨锐（张译饰）为队长整装待发。另一方面，战地女记者夏楠（海清饰）和她的助理一直在跟踪报道恐怖分子，当得知商人威廉因掌握核原料（剧中称黄饼）及制造“脏弹”的技术资料而成为恐怖组织的目标后，夏楠跟助手试图前去阻止。如此一来，夏楠便成了蛟龙突击队和恐怖组织之间的“交集”，他们也在以自己的方式参与到行动中来。</p>
<p>时间紧迫，在“撤侨遇袭可反击，相反则必须避免交火，以免引起外交冲突”的大原则下，海军战舰及蛟龙突击队在恶劣的环境下，停靠海港，成功转移等候在码头的中国侨民，并在激烈的遭遇战之后，营救了被恐怖分子追击的中国领事馆人员。</p>
<p>然而事情尚未完结，就在掩护华侨撤离之际，蛟龙突击队收到中国人质被恐怖分子劫持的消息。众人深感责任重大，义无反顾地再度展开营救行动。经过异常残酷的交火并付出巨大牺牲之后，终于成功营救出人质，也在这个过程中一步步揭开恐怖势力的黄饼阴谋。</p>
<p>最后经过沙漠上的一番战斗之后，叛军首领击毙，阻止了这场阴谋的发生。</p>
<p>所以总的来说有点类似于任务驱动剧情发展，有点僵硬，简单粗暴，开场海上营救任务带出主要人物，此后整个剧情主要就是三大任务，任务一是撤侨，任务二是攻打小镇营救人质，任务三是飞行潜入抢黄饼。</p>
<h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><p>《红海行动》的剧本根据”也门撤侨”真实事件改编，制作总成本据说高达5亿元人民币预算，在国内来说算是投入成本很高的了，导演林超贤此前有作品《逆战》，《湄公河行动》等，据说林导演很擅长拍动作电影，我没有看过他的其他作品，就不瞎掰了。</p>
<p>主演张译和海清相对还算比较熟悉，以前看他们的生活爱情类作品，一下子跳入到战争片中，也不算违和。不过我觉得这部电影中的配角倒是可圈可点，演技在线。</p>
<p>如果玩类似游戏较多的人，对影片中的狙击战，寻找制高点，远程对付迫击阵地，狙击手交锋等等这些应更有感触，影片在这方面处理的很好，尽可能的真实，这也是整个影片最大的看点。</p>
<p>影片配乐整体符合高节奏剧情风格，不知不觉中能牵动观众紧张的听觉神经。不过在面对生命的消亡时，气氛做的不是很足，战争是残酷的，战争不止是打怪升级，如果能有一些人性的渲染，会让影片更有厚度。</p>
<p>抛去开头海面营救的任务，另外三个任务我个人觉得第二个任务最艰险，最激动人心。以至于完成第二个结束时我以为影片即将结束，而我朋友也以为第三个任务会放到续集里再拍，这里不得不说后期有点经费不足的感觉，正常来说，还是应该越往后的任务难度越大，也越精彩吗？</p>
<h4 id="3"><a href="#3" class="headerlink" title="3"></a>3</h4><p>我一向都不是很喜欢个人英雄主义的电影，这也导致很多这类型的视觉效果做的很不错电影会被我拒之门外，有的人觉得去电影院看，要的就是足够冲击的视觉效果，感同身受的音响效果，要不然为啥不在电脑上看呢？这一点只能说萝卜白菜，各有所爱吧。</p>
<p>《红海行动》演绎的不是个人英雄主义，而是“蛟龙突击队”每个成员各司其职的配合，这也是它比较对我胃口的一个原因吧。由上头下达任务，蛟龙突击队随机应变，由真正面临战场的人实时根据战地情况做出决策，每个人都相当于一个移动的站点，都有一定的决策权，这，<strong>是一支精英的团队</strong>。</p>
<blockquote>
<p>《红海行动》的主人翁，既不是个人英雄主义式的，也不是大众集体主义式的，而是士兵突击那种各显神通又精诚合作的精英团队，在感觉上暗含了今天市场经济下的创业文化，也算是新时代精神了。 ——余亮</p>
</blockquote>
<p>精英团队做事不是靠一两个自带主角光环的明星，也不是英明神武令行禁止的领导，而是所有人的高度合作，这样的精英团队，不是立正稍息走正步可以训练出来的，如何让一群一流的人才聚在一起搞事情呢？从影片中我能窥探得一点皮毛。</p>
<p>一是整体团队强烈的认同感，蛟龙突击队整体成员认同中国，认可自己的使命；</p>
<p>二是成员间高度的信任，这种高度的信任则会带来安全感，每个人在其中都可作为一个连接点；</p>
<p>三是有效的反馈机制，每个人都开诚布公的暴露自己可被攻击的薄弱环节，适时向队友求助。</p>
<p>在这样的团队里，领导的主要作用不是直接的命令和控制，而是调节团队的文化。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （六）统一异常处理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （六）统一异常处理/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】——（六）统一异常处理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:30:22+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>在com.hq.demo下新建一个package 为handler，并新建一个GlobalExceptionHandler类</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(value = Exception.class)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Map&lt;String,Object&gt; <span class="title">exceptionHandler</span><span class="params">(HttpServletRequest request, Exception e)</span></span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        modelMap.put(<span class="string">"success"</span>,<span class="keyword">false</span>);</span><br><span class="line">        modelMap.put(<span class="string">"errMsg"</span>,e.getMessage());</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （五）Controller层实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （五）Controller层实现/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （五）Controller层实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:29:02+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-在com-hq-demo下新建一个package-为web，并在web下新建一个AreaController类"><a href="#1-在com-hq-demo下新建一个package-为web，并在web下新建一个AreaController类" class="headerlink" title="1. 在com.hq.demo下新建一个package 为web，并在web下新建一个AreaController类"></a>1. 在com.hq.demo下新建一个package 为web，并在web下新建一个AreaController类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> com.hq.demo.service.AreaService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/superadmin"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AreaService areaService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area"</span>,method = RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">queryArea</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        List&lt;Area&gt; list = areaService.queryArea();</span><br><span class="line">        modelMap.put(<span class="string">"areaList"</span>,list); <span class="comment">//前台将会从areaList获取list</span></span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;<span class="comment">//浏览器中输入http://localhost:9090/SpringBootDemo/superadmin/area可查看到信息</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area/&#123;id&#125;"</span>,method = RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">queryAreaById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer areaId)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Area area = areaService.queryAreaById(areaId);</span><br><span class="line">        modelMap.put(<span class="string">"area"</span>,area);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area"</span>,method = RequestMethod.PUT)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">insertArea</span><span class="params">(@RequestBody Area area)</span></span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> result = areaService.insertArea(area);</span><br><span class="line">        modelMap.put(<span class="string">"success"</span>,result);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area"</span>,method = RequestMethod.PATCH)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">updataArea</span><span class="params">(@RequestBody Area area)</span></span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> result = areaService.updateArea(area);</span><br><span class="line">        modelMap.put(<span class="string">"success"</span>,result);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/area/&#123;id&#125;"</span>,method = RequestMethod.DELETE)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">deleteArea</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer areaId)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; modelMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> result = areaService.deleteArea(areaId);</span><br><span class="line">        modelMap.put(<span class="string">"success"</span>,result);</span><br><span class="line">        <span class="keyword">return</span> modelMap;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-编写controller层的测试类"><a href="#2-编写controller层的测试类" class="headerlink" title="2. 编写controller层的测试类"></a>2. 编写controller层的测试类</h4><pre><code class="java"><span class="keyword">package</span> com.hq.demo.web;

<span class="keyword">import</span> org.junit.Before;
<span class="keyword">import</span> org.junit.Ignore;
<span class="keyword">import</span> org.junit.Test;
<span class="keyword">import</span> org.junit.runner.RunWith;
<span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;
<span class="keyword">import</span> org.springframework.http.MediaType;
<span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;
<span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;
<span class="keyword">import</span> org.springframework.test.web.servlet.setup.MockMvcBuilders;
<span class="keyword">import</span> org.springframework.web.context.WebApplicationContext;

<span class="keyword">import</span> java.time.LocalDateTime;
<span class="keyword">import</span> java.time.ZoneId;
<span class="keyword">import</span> java.util.Date;

<span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;

<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.delete;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.patch;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.put;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
<span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;


<span class="comment">/**</span>
<span class="comment"> * Created by 01106066 on 2018/2/12.</span>
<span class="comment"> */</span>
<span class="meta">@RunWith</span>(SpringRunner.class)
<span class="meta">@SpringBootTest</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaControllerTest</span> </span>{

    <span class="meta">@Autowired</span>
    <span class="keyword">private</span> WebApplicationContext wac;
    <span class="keyword">private</span> MockMvc mockMvc;


    <span class="meta">@Before</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>{
        mockMvc = MockMvcBuilders.webAppContextSetup(wac).build();
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        String result = mockMvc.perform(
                get(<span class="string">"/superadmin/area"</span>)
<span class="comment">//                        .param("username", "jojo")</span>
<span class="comment">//                        .param("age", "18").param("ageTo", "60").param("xxx", "yyy")</span>
                        <span class="comment">// .param("size", "15")</span>
                        <span class="comment">// .param("page", "3")</span>
                        <span class="comment">// .param("sort", "age,desc")</span>
                        .contentType(MediaType.APPLICATION_JSON_UTF8))
                .andExpect(status().isOk()).andExpect(jsonPath(<span class="string">"$.area.length()"</span>).value(<span class="number">2</span>))
                .andReturn().getResponse().getContentAsString();

        System.out.println(result);
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAreaById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        String result = mockMvc.perform(get(<span class="string">"/superadmin/area/2"</span>)
                .contentType(MediaType.APPLICATION_JSON_UTF8))
                .andExpect(status().isOk())
                .andExpect(jsonPath(<span class="string">"$.area.areaName"</span>).value(<span class="string">"华北"</span>))
                .andReturn().getResponse().getContentAsString();

        System.out.println(result);
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        Date date = <span class="keyword">new</span> Date();
        System.out.println(date.getTime());
        String content = <span class="string">"{\"areaName\":\"华中\",\"priority\":0}"</span>;
        String reuslt = mockMvc.perform(put(<span class="string">"/superadmin/area"</span>).contentType(MediaType.APPLICATION_JSON_UTF8)
                .content(content))
                .andExpect(status().isOk())
<span class="comment">//                .andExpect(jsonPath("$.success").value("true")</span>
                .andReturn().getResponse().getContentAsString();

        System.out.println(reuslt);
    }

    <span class="meta">@Test</span>
    <span class="meta">@Ignore</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdataArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        Date date = <span class="keyword">new</span> Date(LocalDateTime.now().plusYears(<span class="number">1</span>).atZone(ZoneId.systemDefault()).toInstant().toEpochMilli());
        System.out.println(date.getTime());
        String content = <span class="string">"{\"areaId\":\"2\", \"areaName\":\"华中-更新\",\"priority\":1}"</span>;
        String reuslt = mockMvc.perform(patch(<span class="string">"/superadmin/area"</span>).contentType(MediaType.APPLICATION_JSON_UTF8)
                .content(content))
                .andExpect(status().isOk())
<span class="comment">//                .andExpect(jsonPath("$.id").value("6"))</span>
                .andReturn().getResponse().getContentAsString();

        System.out.println(reuslt);
    }

    <span class="meta">@Test</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{
        mockMvc.perform(delete(<span class="string">"/superadmin/area/6"</span>)
                .contentType(MediaType.APPLICATION_JSON_UTF8))
                .andExpect(status().isOk());
    }


}
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （四）Service层实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （四）Service层实现/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （四）Service层实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:27:03+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-配置"><a href="#1-配置" class="headerlink" title="1. 配置"></a>1. 配置</h4><p>在com.hq.demo.config新建package service，并新建一个类TransactionManagentConfiguration<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.config.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DataSourceTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.PlatformTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.TransactionManagementConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="comment">//事务管理</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransactionManagentConfiguration</span> <span class="keyword">implements</span> <span class="title">TransactionManagementConfigurer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">annotationDrivenTransactionManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="2-接口"><a href="#2-接口" class="headerlink" title="2. 接口"></a>2. 接口</h4><p>在com.hq.demo下新建service package，并新建<strong>接口</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AreaService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有区域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Area&gt; <span class="title">queryArea</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询区域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> areaId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Area <span class="title">queryAreaById</span><span class="params">(<span class="keyword">int</span> areaId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增区域信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> area</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">insertArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改区域信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> area</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">updateArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id删除区域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> areaId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">deleteArea</span><span class="params">(Integer areaId)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-实现"><a href="#3-实现" class="headerlink" title="3. 实现"></a>3. 实现</h4><p>在com.hq.demo.service下新建impl package，新建AreaServiceImpl实现类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.dao.AreaDao;</span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> com.hq.demo.service.AreaService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaServiceImpl</span> <span class="keyword">implements</span> <span class="title">AreaService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将业务逻辑尽可能放到service层</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AreaDao areaDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Area&gt; <span class="title">queryArea</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> areaDao.queryArea();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Area <span class="title">queryAreaById</span><span class="params">(<span class="keyword">int</span> areaId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> areaDao.queryAreaById(areaId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span> <span class="comment">//事务的控制</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">insertArea</span><span class="params">(Area area)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(area.getAreaName()!=<span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(area.getAreaName()))&#123;</span><br><span class="line">            Date time = <span class="keyword">new</span> Date();</span><br><span class="line">            area.setCreateTime(time);</span><br><span class="line">            area.setLastEditTime(time);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> row = areaDao.insertArea(area);</span><br><span class="line">                <span class="keyword">if</span>(row&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"插入区域信息失败！"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"插入区域信息失败："</span>+e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"区域信息不能为空！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateArea</span><span class="params">(Area area)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(area.getAreaId()!=<span class="keyword">null</span> &amp;&amp; area.getAreaId()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            area.setLastEditTime(<span class="keyword">new</span> Date());</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> row = areaDao.updateArea(area);</span><br><span class="line">                <span class="keyword">if</span>(row&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"更新区域信息失败！"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"更新区域信息失败："</span>+e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"区域id不能为空！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteArea</span><span class="params">(Integer areaId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(areaId!=<span class="keyword">null</span> &amp;&amp; areaId&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> row = areaDao.deleteArea(areaId);</span><br><span class="line">                <span class="keyword">if</span>(row&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"删除区域信息失败！"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"删除区域信息失败："</span>+e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"区域id不能为空！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="解决IDEA下No-Beans-of-“xxx”-type-found的报错"><a href="#解决IDEA下No-Beans-of-“xxx”-type-found的报错" class="headerlink" title="解决IDEA下No Beans of “xxx” type found的报错"></a>解决IDEA下No Beans of “xxx” type found的报错</h4><p>file –&gt; settings –&gt;Editor –&gt; Inspections –&gt; Spring –&gt; Spring Core –&gt; Code –&gt; Autowiring for bean class<br>将级别从Error调成warning，应用即可</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （三）DAO层实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Grace">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寂静的声音">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/11/【SpringBoot+MyBatis搭建微信小程序】—— （三）DAO层实现/" itemprop="url">【SpringBoot+MyBatis搭建微信小程序】—— （三）DAO层实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-11T22:24:48+08:00">
                2018-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-pom配置"><a href="#1-pom配置" class="headerlink" title="1. pom配置"></a>1. pom配置</h4><p>在pom中引入相关的依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--连接池 https://mvnrepository.com/artifact/c3p0/c3p0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="2-mybatis-config的配置"><a href="#2-mybatis-config的配置" class="headerlink" title="2. mybatis-config的配置"></a>2. mybatis-config的配置</h4><p>在src/main/resouce下建mybatis-config.xml，内容如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http//mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置全局属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用jdbc的getGeneratedKeys获取数据库自增主键值--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"useGeneratedKeys"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用列标签替换列别名 默认：true--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"useColumnLabel"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--开启驼峰命名转换：Table(create_time) &amp;ndash;&amp;gt; Entity&#123;createTime&#125;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-datasource和sessionfactorybean的配置"><a href="#3-datasource和sessionfactorybean的配置" class="headerlink" title="3. datasource和sessionfactorybean的配置"></a>3. datasource和sessionfactorybean的配置</h4><p><strong>datasource配置</strong><br>在com.hq.demo下新建packageconfig.dao，新建DataSourceConfiguration类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.config.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.beans.PropertyVetoException;</span><br><span class="line"><span class="keyword">import</span> java.lang.String;</span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//配置MyBatis mapper的扫描路径</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.hq.demo.dao"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.driver&#125;"</span>) <span class="comment">//自动读取application.properties文件中jdbc.driver的值</span></span><br><span class="line">    <span class="keyword">private</span> String jdbcDriver;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.url&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String jdbcUrl;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.username&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String jdbcUsername;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.password&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String jdbcPassword;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"dataSource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ComboPooledDataSource <span class="title">createDataSource</span><span class="params">()</span> <span class="keyword">throws</span> PropertyVetoException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        dataSource.setDriverClass(jdbcDriver);</span><br><span class="line">        dataSource.setJdbcUrl(jdbcUrl);</span><br><span class="line">        dataSource.setUser(jdbcUsername);</span><br><span class="line">        dataSource.setPassword(jdbcPassword);</span><br><span class="line">        <span class="comment">//  关闭连接后不自动commit</span></span><br><span class="line">        dataSource.setAutoCommitOnClose(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>application.properties文件补充：(仅做参考)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driver=com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://10.202.4.39:3307/leechdb?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false</span><br><span class="line">jdbc.username=??</span><br><span class="line">jdbc.password=??</span><br></pre></td></tr></table></figure></p>
<p><strong>sessionfactorybean的配置</strong><br>在com.hq.demo.config.dao下新建类SeesionFactoryConfiguration<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.config.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.String;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.ClassPathResource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SeesionFactoryConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;mybatis_config_file&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String mybatisConfigFilePath;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;mapper_path&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String mapperPath;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;entity_package&#125;"</span>)<span class="comment">//实体类所在的package</span></span><br><span class="line">    <span class="keyword">private</span> String entityPackage;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line"><span class="comment">//    @Qualifier("dataSource")</span></span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"sqlSessionFactory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactoryBean <span class="title">createSqlSessionFactoryBean</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sqlSessionFactoryBean.setConfigLocation(<span class="keyword">new</span> ClassPathResource(mybatisConfigFilePath));</span><br><span class="line">        PathMatchingResourcePatternResolver resolver = <span class="keyword">new</span> PathMatchingResourcePatternResolver();</span><br><span class="line">        String packageSearchPath = PathMatchingResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX+mapperPath;</span><br><span class="line">        sqlSessionFactoryBean.setMapperLocations(resolver.getResources(packageSearchPath));</span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSource);</span><br><span class="line">        sqlSessionFactoryBean.setTypeAliasesPackage(entityPackage);</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>application.properties文件补充：(仅做参考)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mybatis_config_file=mybatis-config.xml</span><br><span class="line">mapper_path=/mapper/**.xml</span><br><span class="line">entity_package=com.hq.demo.entity</span><br></pre></td></tr></table></figure></p>
<p><strong>这里不是采用的SpringBoot默认配置，而是自定义的datasource</strong>，所以看起来复杂许多，<br>如果使用默认配置，可参考：<a href="http://www.cnblogs.com/White-destiny/p/5531367.html" target="_blank" rel="noopener">http://www.cnblogs.com/White-destiny/p/5531367.html</a></p>
<h4 id="4-dao的创建"><a href="#4-dao的创建" class="headerlink" title="4. dao的创建"></a>4. dao的创建</h4><p>在com.hq.demo下新建package，dao，然后新建接口AreaDao<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AreaDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Area&gt; <span class="title">queryArea</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Area <span class="title">queryAreaById</span><span class="params">(<span class="keyword">int</span> areaId)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insertArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateArea</span><span class="params">(Area area)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteArea</span><span class="params">(<span class="keyword">int</span> areaId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="5-mapper的编写"><a href="#5-mapper的编写" class="headerlink" title="5. mapper的编写"></a>5. mapper的编写</h4><p>在src/main/rsource下新建一个directory mapper，然后在mapper下新建AreaDao.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace：命名空间，用于隔离sql，还有一个很重要的作用，后面会讲 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.hq.demo.dao.AreaDao"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        动态代理的开发规范</span></span><br><span class="line"><span class="comment">            1: 映射文件的namespace必须等于接口的全路径名称</span></span><br><span class="line"><span class="comment">            2: 映射文件的sql唯一标示,必须等于接口的方法名称</span></span><br><span class="line"><span class="comment">            3: 映射文件的parameterType必须等于接口方法的参数类型</span></span><br><span class="line"><span class="comment">            4: 映射文件resultType必须等于接口方法的返回类型</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryArea"</span> <span class="attr">resultType</span>=<span class="string">"com.hq.demo.entity.Area"</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">        a.area_id,</span><br><span class="line">        a.area_name,</span><br><span class="line">        a.priority,</span><br><span class="line">        a.create_time,</span><br><span class="line">        a.last_edit_time</span><br><span class="line">        FROM</span><br><span class="line">        tb_area a</span><br><span class="line">        ORDER BY a.priority</span><br><span class="line">        DESC</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryAreaById"</span> <span class="attr">resultType</span>=<span class="string">"com.hq.demo.entity.Area"</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">        a.area_id,</span><br><span class="line">        a.area_name,</span><br><span class="line">        a.priority,</span><br><span class="line">        a.create_time,</span><br><span class="line">        a.last_edit_time</span><br><span class="line">        FROM</span><br><span class="line">        tb_area a</span><br><span class="line">        WHERE a.area_id=#&#123;areaId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertArea"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"areaId"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">keyColumn</span>=<span class="string">"area_id"</span> <span class="attr">parameterType</span>=<span class="string">"com.hq.demo.entity.Area"</span> &gt;</span></span><br><span class="line">        INSERT INTO</span><br><span class="line">        tb_area(area_name,priority,create_time,last_edit_time)</span><br><span class="line">        VALUES(#&#123;areaName&#125;,#&#123;priority&#125;,#&#123;createTime&#125;,#&#123;lastEditTime&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateArea"</span> <span class="attr">parameterType</span>=<span class="string">"com.hq.demo.entity.Area"</span> &gt;</span></span><br><span class="line">        UPDATE  tb_area</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"areaName!=null"</span>&gt;</span>area_name=#&#123;areaName&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"priority!=null"</span>&gt;</span>priority=#&#123;priority&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"lastEditTime!=null"</span>&gt;</span>last_edit_time=#&#123;lastEditTime&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        WHERE area_id=#&#123;areaId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteArea"</span>&gt;</span></span><br><span class="line">        DELETE FROM tb_area</span><br><span class="line">        WHERE area_id=#&#123;areaId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>mapper自动生成工具：mybatis-generator </p>
<h4 id="6-dao层测试"><a href="#6-dao层测试" class="headerlink" title="6. dao层测试"></a>6. dao层测试</h4><p><strong>编写单元测试</strong><br>在Windows环境下，选择AreaDao类，按Alt+Enter键，Create Test；如果是Mac环境下，则是Option+Enter键</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hq.demo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hq.demo.entity.Area;</span><br><span class="line"><span class="keyword">import</span> org.junit.Ignore;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by 01106066 on 2018/2/11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AreaDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AreaDao areaDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        List&lt;Area&gt; areaList = areaDao.queryArea();</span><br><span class="line">        assertEquals(<span class="number">2</span>, areaList.size());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line"><span class="comment">//    @Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAreaById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Area area = areaDao.queryAreaById(<span class="number">1</span>);</span><br><span class="line">        assertEquals(<span class="string">"华南"</span>,area.getAreaName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Area area = <span class="keyword">new</span> Area();</span><br><span class="line">        area.setAreaName(<span class="string">"华东"</span>);</span><br><span class="line">        area.setPriority(<span class="number">0</span>);</span><br><span class="line">        area.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">        <span class="keyword">int</span> row = areaDao.insertArea(area);</span><br><span class="line">        assertEquals(<span class="number">1</span>,row);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Area area = <span class="keyword">new</span> Area();</span><br><span class="line">        area.setAreaId(<span class="number">3</span>);</span><br><span class="line">        area.setAreaName(<span class="string">"华东-更新"</span>);</span><br><span class="line">        area.setLastEditTime(<span class="keyword">new</span> Date());</span><br><span class="line">        <span class="keyword">int</span> row = areaDao.updateArea(area);</span><br><span class="line">        assertEquals(<span class="number">1</span>,row);<span class="comment">//影响行数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteArea</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> row = <span class="keyword">this</span>.areaDao.deleteArea(<span class="number">3</span>);</span><br><span class="line">        assertEquals(<span class="number">1</span>,row);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Grace</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Grace</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
